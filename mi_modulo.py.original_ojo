# -*- coding: utf-8 -*-
from random import randint, random
import urllib

from openerp import models, api, fields
import openerp.addons.decimal_precision as dp
from datetime import datetime, timedelta
import os, subprocess, re
from lxml import etree
import csv, operator

from zipfile import ZipFile
class kiu(models.Model):
    _name = "kiu"
    def create_CMAS(self, cr, uid, context=None):
                    os.system("ls /home/odoo/archivos_kiu/CRS_descomprimidos  > /home/odoo/archivos_kiu/CMAS_descomprimidos.txt")
                    archivo_CMAS ='/home/odoo/archivos_kiu/CMAS_descomprimidos.txt'
                    archi_CMAS = open(archivo_CMAS,'r') 
                    class_cmas_obj = self.pool.get('kiu') 
                    class_PNR_en_CMAS = self.pool.get('kiu') 
                    iterador = 0
                    for archivo_cmas_a_extraer in archi_CMAS:
                               #if iterador < 5:
                                    arch_a_extraerle_datos = '/home/odoo/archivos_kiu/CRS_descomprimidos/'+archivo_cmas_a_extraer
                                    arch_a_extraerle_datos = arch_a_extraerle_datos.strip()
                                    iterador +=1
                
                                    if "formatear_CRS_CMAS.py" == archivo_cmas_a_extraer or archivo_cmas_a_extraer =="lista_CRS_CMAS":
                                              continue
                                    else:
                                                                    archivo = arch_a_extraerle_datos
                                                                    reader= open(archivo, 'r')
                                                                    concuerdan_lineas = 0
                                                                    list_total_real = [] 
                                                                    list_total_calculado = [] 
                                                                    list_equivfare= [] 
                                                                    total_calculado2 = False
                                                                    total_real = False
                                                                    cantidad_archivos  =  0
                                                                    list_total_calculado_REAL = []
                                                                    list_total_real_REAL = []
                                                                    lista_tuplas_pnrs = []
                                                                    numeros_K = 0
                                                                    for line in reader: 
                                                                                  if line[0] == '1':
                                                                                                 fecha_archivo = line[1:8]
                                                                                                 print fecha_archivo
                                                                                  if line[0] == '2':
                                                                                                                lista_monto_6A = []
                                                                                                                lista_monto_AJ = []
                                                                                                                lista_monto_AK = []
                                                                                                                lista_monto_AY = []
                                                                                                                lista_monto_US = []
                                                                                                                lista_monto_EU = []
                                                                                                                lista_monto_VJ = []
                                                                                                                lista_monto_XA = []
                                                                                                                lista_monto_XY = []
                                                                                                                lista_monto_YC = []
                                                                                                                lista_monto_XF = []
                                                                                                                lista_monto_YQ = []
                                                                                                                lista_monto_YN = []
                                                                                                                lista_monto_QC = []
                                                                                                                tipo_pasajero = line[28:30]
                                                                                                                numero_boleto = line[32:45]
                                                                                                                motivo_facturacion_codigo = line[46:52]
                                                                                                                pasajero_principal = line[74:123]
                                                                                                                code_emisor = line[66:71]
                                                                                                                numero_motivos = line[45:46]
                                                                              
                                                                                  if line[0] == '4':
                                                                                                  line4 = line
                                                                                                  if "VE" not in archivo :
                                                                                
                                                                                                                line4 = line
                                                                                                                busqueda_monto = line.find('USD')
                                                                                                                #print busqueda_monto
                                                                
                                                                                                                monto_en_moneda = line[100:108]
                                                                                                                
                                                                                                                print monto_en_moneda
                                                                                                                #print monto_equivfare
                                                                              
                                                                                                                numero_moneda =  line.find('AWG')
                                                                                                                print numero_moneda
                                                                                                                monto_en_moneda = float(monto_en_moneda)
                                                                                                                #print "IMPORTANTE", moneda, monto_en_moneda
                                                                              
                                                                             
                                                                              
                                                                                                                #print line
                                                                                                                #moneda = line[86:89]
                                                                                                                moneda = line[97:100]
                                                                                                                print moneda
                                                                                                                #print "MONEDA", moneda
                                                                              
                                                                                                                record_locator = line[7:14]

                                                                                                                #print "record_locator", record_locator
                                                                                                                ruta = line[20:27]
                                                                                                                #print "RUTA", ruta
                                                                              
                                                                                                                impuesto_principal_1 = line[117:119]
                                                                                                                monto_tax_1 = line[110:117]
                                                                              
                                                                                                                monto_tax_1 = monto_tax_1.strip()
                                                                                                                if monto_tax_1 == "":
                                                                                                                                monto_tax_1 = 0.00
                                                                              
                                                                                                                monto_tax_1 = float(monto_tax_1)
                                                      

                                                                                                                impuesto_principal_2 = line[128:130]
                                                                                                                monto_tax_2 = line[121:128]
                                                                                                                monto_tax_2 = monto_tax_2.strip()
                                                                                                                if monto_tax_2 == "":
                                                                                                                                monto_tax_2 = 0.00
                                                                              
                                                                                                                monto_tax_2 = float(monto_tax_2)
                                                                              
                                                                                                                #print 'OJJJJJJJJJJJJJJJJJOOOOOOOOOOOOOOOO        140.60XTUSD'
                                                                                                                monto_de_otros_TAX = line[131:139]
                                                                                                                total_CMAS =  line[144:152]
                                                                                                                total_CMAS =  total_CMAS.strip()
                                                                                                                if "NO ADC" in total_CMAS:
                                                                                                                                total_CMAS = 0.00
                                                                                                                                print line

                                                                                                                total_CMAS = float(total_CMAS)
                                                                                                                monto_de_otros_TAX = monto_de_otros_TAX.strip()
                                                                                                                if monto_de_otros_TAX == "":
                                                                                                                                monto_de_otros_TAX = 0.00
                                                                                              
                                                                                                                elif monto_de_otros_TAX[0] == "D":
                                                                                                                                monto_de_otros_TAX = monto_de_otros_TAX[1:]
                                                                                                                                monto_de_otros_TAX = monto_de_otros_TAX.strip()
                                                                              
                                                                                                                monto_de_otros_TAX = float(monto_de_otros_TAX)
                                                                                                                #otros_tax_sumados = line[139:141]
                                                                                                                #print "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ", monto_de_otros_TAX, otros_tax_sumados
                                                                              
                                                                                                                #print "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ", "IMPUESTO" ,impuesto_principal_1, monto_tax_1
                                                                              
                                                                                                                #print "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ", "IMPUESTO", impuesto_principal_2, monto_tax_2

                                                                                                                                                                                                                                ### Impuesto 2
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1

                                                                                                                if '6A'  in impuesto_principal_1:
                                                                                                                                monto_6A = monto_tax_1
                                                                                                                                lista_monto_6A.append(monto_6A)
                                                                                                                elif 'AJ'  in impuesto_principal_1:
                            
                                                                                                                                monto_AJ = monto_tax_1
                                                                                                                                lista_monto_AJ.append(monto_AJ)
                                                                                                                elif impuesto_principal_1 == 'AK':
                                                                                                                                monto_AJ = monto_tax_1
                                                                                                                                lista_monto_AK.append(monto_AJ)
                                                                                                                elif impuesto_principal_1 == 'AY':
                                                                                                                                monto_AY = monto_tax_1
                                                                                                                                lista_monto_AY.append(monto_AY)
                                                                                                                elif impuesto_principal_1 == 'US':
                                                                                                                                monto_US = monto_tax_1
                                                                                                                                lista_monto_US.append(monto_US)
                                                                                                                                
                                                                                                                elif 'EU'  in impuesto_principal_1:
                                                                                                                                monto_EU = monto_tax_1
                                                                                                                                lista_monto_EU.append(monto_EU)
                                                                                                                elif impuesto_principal_1 == 'VJ':
                                                                                                                                monto_VJ = monto_tax_1
                                                                                                                                lista_monto_VJ.append(monto_VJ)                
                                                                                                                elif impuesto_principal_1 == 'XA':
                                                                                                                                monto_XA = monto_tax_1
                                                                                                                                lista_monto_XA.append(monto_XA)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'XY':
                                                                                                                                monto_XY = monto_tax_1
                                                                                                                                lista_monto_XY.append(monto_XY)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'YC':
                                                                                                                                monto_YC = monto_tax_1
                                                                                                                                lista_monto_YC.append(monto_YC)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'XF':
                                                                                                                                monto_XF = monto_tax_1
                                                                                                                                lista_monto_XF.append(monto_XF)
                                                                                                                                                
                                                                                                                                
                                                                                                                elif 'YQ'  in impuesto_principal_1:
                                                                                                                                monto_YQ = monto_tax_1
                                                                                                                                lista_monto_YQ.append(monto_YQ)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'YN':
                                                                                                                                monto_YN = monto_tax_1
                                                                                                                                lista_monto_YN.append(monto_YN)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'QC':
                                                                                                                                monto_QC = monto_tax_1
                                                                                                                                lista_monto_QC.append(monto_QC)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_1 == 'Y1C':
                                                                                                                                monto_Y1C = monto_tax_1
                                                                                                                                lista_monto_YC.append(monto_Y1C)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_1 == 'X1Y':
                                                                                                                                monto_X1Y = monto_tax_1
                                                                                                                                lista_monto_XY.append(monto_X1Y)
                                                                                                                           
                                                                                                                     
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1

                                                                                                                if '6A'  in impuesto_principal_2:
                                                                                                                                monto_6A = monto_tax_2
                                                                                                                                lista_monto_6A.append(monto_6A)
                                                                                                                elif 'AJ'  in impuesto_principal_2:
                            
                                                                                                                                monto_AJ = monto_tax_2
                                                                                                                                lista_monto_AJ.append(monto_AJ)
                                                                                                                elif impuesto_principal_2 == 'AK':
                                                                                                                                monto_AJ = monto_tax_2
                                                                                                                                lista_monto_AK.append(monto_AJ)
                                                                                                                elif impuesto_principal_2 == 'AY':
                                                                                                                                monto_AY = monto_tax_2
                                                                                                                                lista_monto_AY.append(monto_AY)
                                                                                                                elif impuesto_principal_2 == 'US':
                                                                                                                                monto_US = monto_tax_2
                                                                                                                                lista_monto_US.append(monto_US)
                                                                                                                                
                                                                                                                elif 'EU'  in impuesto_principal_2:
                                                                                                                                monto_EU = monto_tax_2
                                                                                                                                lista_monto_EU.append(monto_EU)
                                                                                                                elif impuesto_principal_2 == 'VJ':
                                                                                                                                monto_VJ = monto_tax_2
                                                                                                                                lista_monto_VJ.append(monto_VJ)                
                                                                                                                elif impuesto_principal_2 == 'XA':
                                                                                                                                monto_XA = monto_tax_2
                                                                                                                                lista_monto_XA.append(monto_XA)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'XY':
                                                                                                                                monto_XY = monto_tax_2
                                                                                                                                lista_monto_XY.append(monto_XY)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'YC':
                                                                                                                                monto_YC = monto_tax_2
                                                                                                                                lista_monto_YC.append(monto_YC)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'XF':
                                                                                                                                monto_XF = monto_tax_2
                                                                                                                                lista_monto_XF.append(monto_XF)
                                                                                                                                                
                                                                                                                                
                                                                                                                elif 'YQ'  in impuesto_principal_2:
                                                                                                                                monto_YQ = monto_tax_2
                                                                                                                                lista_monto_YQ.append(monto_YQ)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'YN':
                                                                                                                                monto_YN = monto_tax_2
                                                                                                                                lista_monto_YN.append(monto_YN)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'QC':
                                                                                                                                monto_QC = monto_tax_2
                                                                                                                                lista_monto_QC.append(monto_QC)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_2 == 'Y1C':
                                                                                                                                monto_Y1C = monto_tax_2
                                                                                                                                lista_monto_YC.append(monto_Y1C)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_2 == 'X1Y':
                                                                                                                                monto_X1Y = monto_tax_2
                                                                                                                                lista_monto_XY.append(monto_X1Y)
                                                                                                                           
                                                                                                                     
                                                                                                                concuerdan_lineas += 1
                                                                                                                
                                                                                                                
                                                                                                  elif "VE" == archivo_cmas_a_extraer[0:2] :
                                                                                                                  
                                                                                                                line4 = line
                                                                                                                print line4
                                                                                                                RUTA = line[20:29]
                                                                                                                print RUTA
                                                                                                                
                                                                                                                moneda = line[86:89]
                                                                                                                print moneda
                                                                                                                
                                                                                                                
                                                                                                                monto_total_dolares = line[89:97]
                                                                                                                
                                                                                                                print  "monto_equivfare", monto_total_dolares
                                                                                                                
                                                                                                                monto_equivfare_BS = line[100:108]
                                                                                                                monto_equivfare_BS = monto_equivfare_BS.strip()
                                                                                                                
                                                                                                                print "monto_equivfare_BS",monto_equivfare_BS
                                                                                                                
                                                                                                                
                                                                                                                monto_en_moneda = line[100:106]
                                                                                                                monto_en_moneda = float(monto_en_moneda)
                                                                                                                print monto_en_moneda, "monto_en_monedamonto_en_moneda"
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                total_VEF = line[141:156]
                                                                                                                print total_VEF
                                                                                                                total_CMAS = line[144:152]
                                                                                                                if "NO ADC" in total_CMAS:
                                                                                                                                total_CMAS = 0.00
                                                                                                                                print line
                                                                                                                print "TOTAL total_CMAS" , total_CMAS
                                                                                                                
                                                                                                                impuesto_principal_1 = line[109:120]
                                                                                                                print impuesto_principal_1
                                                                                                                print "impuesto_principal_1 FLOAT" , line[109:117]
                                                                                                                
                                                                                                                impuesto_principal_2 = line[119:130]
                                                                                                                print impuesto_principal_2
                                                                                                                
                                                                                                                print "impuesto_principal_2 FLOAT" , line[119:128]
                                                                                                                
                                                                                                                
                                                                                                                print "IMPORTANTE", moneda, monto_total_dolares
                                                                                                                
                                                                                                                record_locator = line[7:14]

                                                                                                                print "record_locator", record_locator
                                                                              
                                                                             
                                                                              
                                                                              
                                                                                                                monto_tax_1 = line[109:117]
                                                                              
                                                                                                                monto_tax_1 = monto_tax_1.strip()
                                                                                                                if monto_tax_1 == "":
                                                                                                                                monto_tax_1 = 0.00
                                                                                                                elif  "D" in monto_tax_1:
                                                                                                                                print monto_tax_1, "CAMBIANDOOOOOOOOOO"
                                                                                                                                monto_tax_1 = 0.00
                                                                                                                        
                                                                                                                elif  "PD" in monto_tax_1:
                                                                                                                                print monto_tax_1, "CAMBIANDOOOOOOOOOO"
                                                                                                                                monto_tax_1 = 0.00        
                                                                                                             
                                                                                                                monto_tax_1 = float(monto_tax_1)
                                                                                                              
                                                                                                                monto_tax_2 = line[119:128]
                                                                                                                monto_tax_2 = monto_tax_2.strip()
                                                                                                                if monto_tax_2 == "":
                                                                                                                                monto_tax_2 = 0.00
                                                                                                                    
                                                                                                                elif  "D" in monto_tax_2:
                                                                                                                                print monto_tax_2, "CAMBIANDOOOOOOOOOO"
                                                                                                                                monto_tax_2 = 0.00
                                                                                                                        
                                                                                                                elif  "PD" in monto_tax_2:
                                                                                                                                print monto_tax_2, "CAMBIANDOOOOOOOOOO"
                                                                                                                                monto_tax_2 = 0.00  
                                                                                                                monto_tax_2 = float(monto_tax_2)
                                                                                                                                                                                                                    ### Impuesto 2
                                                                                                                  ### Impuesto 1
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1

                                                                                                                if '6A'  in impuesto_principal_1:
                                                                                                                                monto_6A = monto_tax_1
                                                                                                                                lista_monto_6A.append(monto_6A)
                                                                                                                elif 'AJ'  in impuesto_principal_1:
                            
                                                                                                                                monto_AJ = monto_tax_1
                                                                                                                                lista_monto_AJ.append(monto_AJ)
                                                                                                                elif impuesto_principal_1 == 'AK':
                                                                                                                                monto_AJ = monto_tax_1
                                                                                                                                lista_monto_AK.append(monto_AJ)
                                                                                                                elif impuesto_principal_1 == 'AY':
                                                                                                                                monto_AY = monto_tax_1
                                                                                                                                lista_monto_AY.append(monto_AY)
                                                                                                                elif impuesto_principal_1 == 'US':
                                                                                                                                monto_US = monto_tax_1
                                                                                                                                lista_monto_US.append(monto_US)
                                                                                                                                
                                                                                                                elif 'EU'  in impuesto_principal_1:
                                                                                                                                monto_EU = monto_tax_1
                                                                                                                                lista_monto_EU.append(monto_EU)
                                                                                                                elif impuesto_principal_1 == 'VJ':
                                                                                                                                monto_VJ = monto_tax_1
                                                                                                                                lista_monto_VJ.append(monto_VJ)                
                                                                                                                elif impuesto_principal_1 == 'XA':
                                                                                                                                monto_XA = monto_tax_1
                                                                                                                                lista_monto_XA.append(monto_XA)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'XY':
                                                                                                                                monto_XY = monto_tax_1
                                                                                                                                lista_monto_XY.append(monto_XY)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'YC':
                                                                                                                                monto_YC = monto_tax_1
                                                                                                                                lista_monto_YC.append(monto_YC)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'XF':
                                                                                                                                monto_XF = monto_tax_1
                                                                                                                                lista_monto_XF.append(monto_XF)
                                                                                                                                                
                                                                                                                                
                                                                                                                elif 'YQ'  in impuesto_principal_1:
                                                                                                                                monto_YQ = monto_tax_1
                                                                                                                                lista_monto_YQ.append(monto_YQ)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'YN':
                                                                                                                                monto_YN = monto_tax_1
                                                                                                                                lista_monto_YN.append(monto_YN)
                                                                                                                                                
                                                                                                                elif impuesto_principal_1 == 'QC':
                                                                                                                                monto_QC = monto_tax_1
                                                                                                                                lista_monto_QC.append(monto_QC)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_1 == 'Y1C':
                                                                                                                                monto_Y1C = monto_tax_1
                                                                                                                                lista_monto_YC.append(monto_Y1C)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_1 == 'X1Y':
                                                                                                                                monto_X1Y = monto_tax_1
                                                                                                                                lista_monto_XY.append(monto_X1Y)
                                                                                                                           
                                                                                                                     
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1
                                                                                                                ### Impuesto 1

                                                                                                                if '6A'  in impuesto_principal_2:
                                                                                                                                monto_6A = monto_tax_2
                                                                                                                                lista_monto_6A.append(monto_6A)
                                                                                                                elif 'AJ'  in impuesto_principal_2:
                            
                                                                                                                                monto_AJ = monto_tax_2
                                                                                                                                lista_monto_AJ.append(monto_AJ)
                                                                                                                elif impuesto_principal_2 == 'AK':
                                                                                                                                monto_AJ = monto_tax_2
                                                                                                                                lista_monto_AK.append(monto_AJ)
                                                                                                                elif impuesto_principal_2 == 'AY':
                                                                                                                                monto_AY = monto_tax_2
                                                                                                                                lista_monto_AY.append(monto_AY)
                                                                                                                elif impuesto_principal_2 == 'US':
                                                                                                                                monto_US = monto_tax_2
                                                                                                                                lista_monto_US.append(monto_US)
                                                                                                                                
                                                                                                                elif 'EU'  in impuesto_principal_2:
                                                                                                                                monto_EU = monto_tax_2
                                                                                                                                lista_monto_EU.append(monto_EU)
                                                                                                                elif impuesto_principal_2 == 'VJ':
                                                                                                                                monto_VJ = monto_tax_2
                                                                                                                                lista_monto_VJ.append(monto_VJ)                
                                                                                                                elif impuesto_principal_2 == 'XA':
                                                                                                                                monto_XA = monto_tax_2
                                                                                                                                lista_monto_XA.append(monto_XA)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'XY':
                                                                                                                                monto_XY = monto_tax_2
                                                                                                                                lista_monto_XY.append(monto_XY)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'YC':
                                                                                                                                monto_YC = monto_tax_2
                                                                                                                                lista_monto_YC.append(monto_YC)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'XF':
                                                                                                                                monto_XF = monto_tax_2
                                                                                                                                lista_monto_XF.append(monto_XF)
                                                                                                                                                
                                                                                                                                
                                                                                                                elif 'YQ'  in impuesto_principal_2:
                                                                                                                                monto_YQ = monto_tax_2
                                                                                                                                lista_monto_YQ.append(monto_YQ)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'YN':
                                                                                                                                monto_YN = monto_tax_2
                                                                                                                                lista_monto_YN.append(monto_YN)
                                                                                                                                                
                                                                                                                elif impuesto_principal_2 == 'QC':
                                                                                                                                monto_QC = monto_tax_2
                                                                                                                                lista_monto_QC.append(monto_QC)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_2 == 'Y1C':
                                                                                                                                monto_Y1C = monto_tax_2
                                                                                                                                lista_monto_YC.append(monto_Y1C)
                                                                                                                           
                                                                                                                                                       
                                                                                                                elif impuesto_principal_2 == 'X1Y':
                                                                                                                                monto_X1Y = monto_tax_2
                                                                                                                                lista_monto_XY.append(monto_X1Y)
                                                                                                                           
                                                                                                                     
                                                                                                                     
                                                                                                                monto_de_otros_TAX = line[130:139]
                                                                                                                monto_de_otros_TAX = monto_de_otros_TAX.strip()
                                                                                                                #total_CMAS =  line[144:152]
                                                                                                                #total_CMAS =  total_CMAS.strip()
                                                                                                                #if "NO ADC" in total_CMAS:
                                                                                                                                #total_CMAS = 0.0
                                                                                                                                #print line

                                                                                                                #total_CMAS = float(total_CMAS)
                                                                                                                if monto_de_otros_TAX == "":
                                                                                                                                monto_de_otros_TAX = 0.00

                                                                                                                elif  "D" in monto_de_otros_TAX:
                                                                                                                                print monto_de_otros_TAX, "CAMBIANDOOOOOOOOOO"
                                                                                                                                monto_de_otros_TAX = 0.00
                                                                                                                        
                                                                                                                elif  "PD" in monto_de_otros_TAX:
                                                                                                                                print monto_de_otros_TAX, "CAMBIANDOOOOOOOOOO"
                                                                                                                                monto_de_otros_TAX = 0.00        
                                                                                                                        
                                                                                                                monto_de_otros_TAX = float(monto_de_otros_TAX)
                                                                                                                otros_tax_sumados = line[139:141]
                                                                                                                print "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ", monto_de_otros_TAX, otros_tax_sumados
                                                                              
                                                                                                                print "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ", "IMPUESTO" ,impuesto_principal_1, monto_tax_1
                                                                              
                                                                                                                print "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ", "IMPUESTO", impuesto_principal_2, monto_tax_2
                                                                                                                
                                                                                                                print monto_en_moneda ,monto_de_otros_TAX, monto_tax_2 , monto_tax_1
                                                                                                                print "TOTAL TOTAL TOTAL son:", monto_en_moneda +monto_de_otros_TAX+ monto_tax_2 + monto_tax_1
                                                                                                                print "DEBERIA DAR:", total_CMAS

                                                                                                                concuerdan_lineas += 1
                                                                                  otros_tax = [] 
                                                
                                                
                                                                                  if line[0] == '7':
           
                                                                                              #if "VE" == archivo_cmas_a_extraer[0:2] :
                                                                                                                  
                                                                                                                #line7 = line          
                                                                                                                #print line7
                                                        
                                                                                              #elif "VE" not in archivo :
                                                                                                 #print line
                                                                                                  if line[94]== "1":
                                                                                                                  line_vieja = line
                                                                                                                  line = line[0:94]+line[95:]
                                                                                           
                                  
                                                                                                  lista_impuestos = ['6A','AJ', 'AK', "AY", "US","EU", "VJ" , "XA","XY","YC","XF","YQ","YN", "QC" , "Y1C", "X1Y"]
                                                                                                  
                                                                                                  
                                                                                                  for impuestos_2 in lista_impuestos:
                                                                                                              if (impuestos_2 == impuesto_principal_1) or (impuestos_2 == impuesto_principal_2):
                                                                                                                                   print impuestos_2 
                                                                                                                                   print impuesto_principal_1 
                                                                                                                                   print impuesto_principal_2 
                                                                                                                              
                                                                                                              else:
                                                                                                                  #print impuestos_2, "#####################################################3##"
                                                                                                                  impuesto_sec = line.find(impuestos_2) 
                                                                                                                  revisar = line[impuesto_sec+2]
                                                            
                                                                                
                                                                                                                  if impuesto_sec !=-1:
                                                                                                                           #print "impuesto_sec", line
                                                                                                                            if revisar == "D":
                                                                                                                                 #print "SACAR"
                                                                                                                                 pass
                                                                                                                            else:
                                                                                                                                #print line      
                                                                                                                                #print "############################"
                                                                                                                                 #print "############################"
                                                                                                                                #print "TAX:  ", line[impuesto_sec:impuesto_sec+2]
                                                                                                                                 impuesto = line[impuesto_sec:impuesto_sec+2]
                                                                                                                                 if (line[impuesto_sec - 5]) == " ":
                                                                                                                                                  monto_tax = line[impuesto_sec-5:impuesto_sec]
                                                                                                                
                                                                                                                                                  #print "Monto:  ",monto_tax,"Solo tiene 4 Caracteres"
                                                                                                                                 elif (line[impuesto_sec  - 6]) == " " :
                                                                                                                                                  monto_tax = line[impuesto_sec-6:impuesto_sec]
                                                                                                                                                  #print "Monto:  ", monto_tax,"Solo tiene 5 Caracteres  "
                                                                                                                                 elif (line[impuesto_sec  - 7]) == " ":
                                                                                                                                                  monto_tax = line[impuesto_sec-7:impuesto_sec]
                                                                                                                                                  #print "Monto:  ", monto_tax,"Solo tiene 6 Caracteres  "
                                                                                                                                 elif (line[impuesto_sec  - 8] ) == " ":
                                                                                                                                                  monto_tax =  line[impuesto_sec-8:impuesto_sec]
                                                                                                                                                  #print "Monto:  ", monto_tax,"Solo tiene 7 Caracteres  "
                                                                                                                                 elif (line[impuesto_sec  - 9]) == " ":
                                                                                                                                                  monto_tax = line[impuesto_sec-9:impuesto_sec]
                                                                                                                                                 #print "Monto:  ", monto_tax ,"Solo tiene 8 Caracteres  "
                                                                                                                                 monto_tax = str(monto_tax)
                                                                                               
                                                                                                                                 monto_tax = monto_tax.strip()
                                                                                               
                                                                                                                                 #print "PRINT -3",line[impuesto_sec+2]
                                                                                                                                 #print "impuesto",impuesto
                                                                                                                                 #print "PRINT",monto_tax
                                                                                               
                                                                                                                                 if monto_tax == "":
                                                                                                                                                 monto_tax = 0.00
                                                                                                                                 elif len(monto_tax)< 4:
                                                                                                                                                 pass
                                                                                                                                                 #print monto_tax
                                                                                               
                                                                                               

                                                                                                                                 elif monto_tax[-4] == ".":
                                                                                                                                                 #print "ALERTAAAAAAAAAAAAAAAAAAAA",monto_tax
                                                                                                                                                 #print "ALERTAAAAAAAAAAAAAAAAAAAA",monto_tax
                                                                                                                                                 #print "ALERTAAAAAAAAAAAAAAAAAAAA",monto_tax
                                                                                                                                                 #print "ALERTAAAAAAAAAAAAAAAAAAAA",monto_tax

                                                                                                                                                 if monto_tax[-3] == '1':
                                                                                                                                                                 monto_tax =  monto_tax[0:-3]+monto_tax[-2:]
                                                                                                                                                                 #print "AHORA AHORA SIIIIIIIIIIIIIIIIII", monto_tax
                                                                                                                                                                 #print "AHORA AHORA SIIIIIIIIIIIIIIIIII", monto_tax
                                                                                                                                                                 #print "AHORA AHORA SIIIIIIIIIIIIIIIIII", monto_tax
                                                                                                                                                                 #print line ,"###############"
                                                                                                                                                 elif monto_tax[-2] == '1' and  monto_tax[-3] != '.' :
                                                                                                                                                                 monto_tax =  monto_tax[0:-2]+monto_tax[-1:]
                                                                                                                                                                 #print "AHORA AHORA SIIIIIIIIIIIIIIIIII2222", monto_tax
                                                                                                                                                                 #print "AHORA AHORA SIIIIIIIIIIIIIIIIII2222", monto_tax
                                                                                                                                                                 #print "AHORA AHORA SIIIIIIIIIIIIIIIIII2222", monto_tax
                                                                                                                                                                 #print line ,"###############"
                                                                                               
                                                                                                                                 monto_tax = str(monto_tax)
                                                                                                                                 if monto_tax[0:2]== "PD":
                                                                                                                                               monto_tax= monto_tax[2:]  
                                                                                                         
                                                                                                                                 elif monto_tax[0:2]== "XT":
                                                                                                                                               monto_tax= monto_tax[2:]                                                                                                 
                                                                                                                          
                                                                                                                                 elif monto_tax[0:3]== "1PD":
                                                                                                                                               monto_tax= monto_tax[3:]  
                                                                                                             
                                                                                                                                 elif monto_tax[0:3]== "P1D":
                                                                                                                                               monto_tax= monto_tax[3:]       
                                                                                                                                         
                                                                                                                                 elif monto_tax[0:3]== "P3D":
                                                                                                                                               monto_tax= monto_tax[3:]       
                                                                                                                                 
                                                                                                                                 elif monto_tax[0:3]== "3PD":
                                                                                                                                               monto_tax= monto_tax[3:]       
                                                                                                             
                                                                                                                                 elif "EQUIP" == monto_tax:
                                                                                                                                                 monto_tax = 0.00                       
                                                                                                             
                                                                                                                                 elif "KG\C" in monto_tax:
                                                                                                                                                 monto_tax = 0.00
                                                                                                               
                                                                                                                                 elif "X/AUA N" == monto_tax:
                                                                                                                                                 monto_tax = 0.00
                                                                                                                             
                                                                                                                                 elif "KG\EQUIP" == monto_tax:
                                                                                                                                                 monto_tax = 0.00
                                                                                                                                       
                                                                                                                                 elif "KG\EUIQP" == monto_tax:
                                                                                                                                                 monto_tax = 0.00
                                                                                                                                        
                                                                                                                                 elif "PER KG" in monto_tax:
                                                                                                                                                 monto_tax = 0.00
                                                                                                                                                
                                                                                                                                 elif "KG" in monto_tax:
                                                                                                                                                 monto_tax = 0.00
                                                                                                                               
                                                                                                                                 elif "N" == monto_tax[-1]:
                                                                                                                                                 monto_tax =monto_tax[0:-1]
                                                                                                                  
                                                                                                                                 monto_tax = float(monto_tax)
                                                                                                                                 monto_tax = round(monto_tax,2)
                                                                                                                                 
                                                                                                                                 if impuestos_2 == '6A':
                                                                                                                                                      print "MONTOOOOOOO 6A"
                                                                                                                                                      monto_6A = monto_tax
                                                                                                                                                      lista_monto_6A.append(monto_6A)
                                                                                                                                                
                                                                                                                                 elif impuestos_2 == 'AJ':
                                                                                                                                                 print "MONTOOOOOOO AJ"
                                                                                                                                                 monto_AJ = monto_tax
                                                                                                                                                 lista_monto_AJ.append(monto_tax)
                                                                                                                                 elif impuestos_2 == 'AK':
                                                                                                                                                 print "MONTOOOOOOO AK"
                                                                                                                                                 monto_AK = monto_tax
                                                                                                                                                 lista_monto_AK.append(monto_tax)
                                                                                                                                 elif impuestos_2 == 'AY':
                                                                                                                                                 monto_AY = monto_tax
                                                                                                                                                 lista_monto_AY.append(monto_tax)
                                                                                                                                 elif impuestos_2 == 'US':
                                                                                                                                                 monto_US = monto_tax
                                                                                                                                                 lista_monto_US.append(monto_tax)
                                                                                                                                 elif impuestos_2 == 'EU':
                                                                                                                                                 monto_EU = monto_tax
                                                                                                                                                 lista_monto_EU.append(monto_tax)
                                                                                                                                 elif impuestos_2 == 'VJ':
                                                                                                                                                 monto_VJ = monto_tax
                                                                                                                                                 lista_monto_VJ.append(monto_tax)
                                                                                                                                 elif impuestos_2 == 'XA':
                                                                                                                                                 monto_XA = monto_tax
                                                                                                                                                 lista_monto_XA.append(monto_tax)
                                                                                                                                                                 
                                                                                                                                 elif impuestos_2 == 'XY':
                                                                                                                                                 monto_XY = monto_tax
                                                                                                                                                 lista_monto_XY.append(monto_tax)
                                                                                                                                                                 
                                                                                                                                 elif impuestos_2 == 'YC':
                                                                                                                                                 monto_YC = monto_tax
                                                                                                                                                 lista_monto_YC.append(monto_tax)
                                                                                                                                                                 
                                                                                                                                 elif impuestos_2 == 'XF':
                                                                                                                                                 monto_XF = monto_tax
                                                                                                                                                 lista_monto_XF.append(monto_tax)
                                                                                                                                                                 
                                                                                                                                 elif impuestos_2 == 'YQ':
                                                                                                                                                 monto_YQ = monto_tax
                                                                                                                                                 lista_monto_YQ.append(monto_tax)
                                                                                                                                                                 
                                                                                                                                 elif impuestos_2 == 'YN':
                                                                                                                                                 monto_YN = monto_tax
                                                                                                                                                 lista_monto_YN.append(monto_tax)
                                                                                                                                                                 
                                                                                                                                 elif impuestos_2 == 'QC':
                                                                                                                                                 monto_QC = monto_tax
                                                                                                                                                 lista_monto_QC.append(monto_tax)
                                                                                                                                            
                                                                                                                                                                        
                                                                                                                                 elif 'Y1C' in impuestos_2:
                                                                                                                                                 monto_YC = monto_tax
                                                                                                                                                 lista_monto_YC.append(monto_tax)
                                                                                                                                            
                                                                                                                                                                        
                                                                                                                                 elif 'X1Y' in impuestos_2:
                                                                                                                                                 monto_XY = monto_tax
                                                                                                                                                 lista_monto_XY.append(monto_tax)
                                                                                                            
                                                                                                                                 otros_tax.append(monto_tax)

                                                                             
                                                                                                  total_real =  monto_en_moneda + monto_tax_1 + monto_tax_2 + monto_de_otros_TAX
                                                                                                  sumatoria_desglosados = sum(otros_tax)
                                                                                                  if sumatoria_desglosados == 0:
                                                                                                                  sumatoria_desglosados = monto_de_otros_TAX
                                                                                                  total_calculado =  monto_en_moneda + monto_tax_1 + monto_tax_2 + sumatoria_desglosados
                                                                                                  #print total_calculado
                                                                                                  total_real = round(total_real,2)
                                                                
                                                                
                                                                                                  total_calculado = round(total_calculado,2)
                                                                                                  #print 'monto_de_otros_TAX', monto_de_otros_TAX
                                                                                                  #print 'sumatoria_desglosados', sumatoria_desglosados
                                                                                                  #print 'total_calculado', total_calculado
                                                                                                  #print 'total_real', total_real
                                                                                                  #print "GRAN TOTALLL Calculado           ",total_real

                                                                                                  if total_real != total_calculado:
                                                                                                                                  #print "IMPUSTOS", impuestos_2 ,"ARCHIVO", archivo
                                                                                                                                  print "##################"
                                                                                                                                  print line
                                                                                                                                  print line4
                                                                                                                                  print line_vieja
                                                                                                                                  print "Archivo", archivo
                                                                                                
                                                                                                                                  print "monto_de_otros_TAX", monto_de_otros_TAX
                                                                                                                                  print "sumatoria_desglosados", sumatoria_desglosados

                                                                                                                                  #print "MODIFICA       "
                                                                                                                                  #print "MODIFICA       "   
                                                                                                                                  #print "MODIFICA       "
                                                                                                                                  print "total_calculado       ", total_calculado
                                                                                                                                  print "total_real       ",total_real
                                                                                                                                  total_calculado2 =  monto_en_moneda + monto_tax_1 + monto_tax_2 + sumatoria_desglosados
                                                                                                                                  print    total_calculado2                                                                                             
                                                                                                                                  print "Diff     ",round(total_calculado2,4) , round(total_real,4)
                                                                                                                                  print "total_calculaditoooo  &&&&&&&&&&&&     ",total_calculado2
                                                                                                                                  print round(total_real,4) == round(total_calculado2,4)

                                                                                                                                  if cantidad_archivos != 0:
                                                                                                                                                        print cantidad_archivos
                                                                                                                                  cantidad_archivos  +=  1
                                                                                                                                  total_calculado = total_calculado2
                                                                                                                                  print cantidad_archivos
                                                                                      
                                                                                  if line[0] == '5':
                                                                                                 pass
                                                                                                 
                                                                                  if line[0] == '6':
                                                                                                 pass
                                                                                                 
                                                                                  if line[0] == '8':
                                                                                                 pass
                                                                
                                                                                  if line[0] == '9':
                                                                                                 fecha_archivo = line[1:8]
                                                                                                 
                                                                                  if line[0] == 'K':
                                                                                              #if "VE" not in archivo :

                                                                                                                pnr_localizador = line[100:]
                                                                                                                IssueCode = line[7:20]
                                                                                                                k_in_cmas = line[0:7]
                                                                                                                list_total_calculado_REAL.append(total_calculado)
                                                                                                                list_total_real_REAL.append(total_real)
                                                                                                                print total_calculado, total_CMAS , "#####################$$$$$$$$$$##################"
                                                                                                                total_CMAS = float(total_CMAS)
                                                                                                                if (total_calculado > total_real) and (total_calculado - total_real < 1):
                                                                                                                                total_calculado = total_calculado - (total_calculado - total_real)
                                                                                                                
                                                                                                                if (total_calculado < total_real) and (total_real - total_calculado < 1):
                                                                                                                                
                                                                                                                                total_calculado = total_calculado + (total_real - total_calculado)
                                                                                                                                
                                                                                                                list_total_calculado_REAL.append(total_calculado)
                                                                                                                list_total_real_REAL.append(total_real)
                                                                                                                
                                                                                                                dict__datos_pnr = {
                                
                                                                                                                  'name': pnr_localizador,
                                                                                                                  'sumatoria_desglosados': sumatoria_desglosados,
                                                                                                                  'monto_de_otros_TAX': monto_de_otros_TAX,
                                                                                                                  'monto_tax_2': monto_tax_2,
                                                                                                                  'monto_tax_1': monto_tax_1,
                                                                                                                  'monto_en_moneda': monto_en_moneda,
                                                                                                                  'total_calculado': total_calculado,
                                                                                                                  'total_real': total_real,
                                                                                                                  'total_CMAS': total_CMAS,
                                                                                                                  'tipo_pasajero': tipo_pasajero,
                                                                                                                  'pasajero_principal': pasajero_principal,
                                                                                                                                 
                                                                                                                  'monto_6A': sum(lista_monto_6A),
                                                                                                                  'monto_AJ': sum(lista_monto_AJ),
                                                                                                                  'monto_AK': sum(lista_monto_AK),
                                                                                                                  'monto_AY': sum(lista_monto_AY),
                                                                                                                  'monto_US': sum(lista_monto_US),
                                                                                                                  'monto_EU': sum(lista_monto_EU),
                                                                                                                  'monto_VJ': sum(lista_monto_VJ),
                                                                                                                  'monto_XA': sum(lista_monto_XA),
                                                                                                                  'monto_XY': sum(lista_monto_XY),
                                                                                                                  'monto_YC': sum(lista_monto_YC),
                                                                                                                  'monto_XF': sum(lista_monto_XF),
                                                                                                                  'monto_YQ': sum(lista_monto_YQ),
                                                                                                                  'monto_YN': sum(lista_monto_YN),
                                                                                                                  'monto_QC': sum(lista_monto_QC),
                                                                                                                 

                                                                                                                
                                                                                                         }
                                                                                                                print "###########$$$$$$$#########"
                                                                                                                print dict__datos_pnr
                                                                                                                tupla_datos_pnr = (0, id, dict__datos_pnr)
                                                                                                                lista_tuplas_pnrs.append(tupla_datos_pnr)
                                                                                                                numeros_K += 1
                                                               
                                                                                  if line[0] == 'Z':
                                                                                        #if "VE" not in archivo :
                                                                                            if numeros_K > 0:
                                                                                                  buscar_cmas = self.pool.get('kiu').search(cr,uid,[('name', '=', archivo_cmas_a_extraer),],context=context)
                                                                                                  if buscar_cmas:
                                                                                                                  print "EXISTE"
                                                                                                                  subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/archivos_procesados/'])
                                                                                                                  print "moviendo", arch_a_extraerle_datos
                                                                                                  else:
                                                                                                                  print      archivo_cmas_a_extraer, "archivo_cmas_a_extraer NO EXISTE"
                                                                                                                  
                                                                                                                  total_real_REAL = sum(list_total_real_REAL)
                                                                                                                  
                                                                                                                  total_calculado_REAL = sum(list_total_calculado_REAL)
                                                                                                                  print total_real_REAL, total_calculado_REAL
                                                                                                                  total_real_REAL = float(total_real_REAL)
                                                                                                                  total_calculado_REAL = float(total_calculado_REAL)
                                                                                                                  print total_real_REAL, total_calculado_REAL
                                                                                                                  class_cmas_obj.create(cr,uid, {
                                                                                                                         'name': archivo_cmas_a_extraer,
                                                                                                                          'nombres': archivo_cmas_a_extraer,
                                                                                                                          'fecha_archivo': fecha_archivo,
                                                                                                                           'pnr_ids': lista_tuplas_pnrs,
                                                                                                                            'total_calculado_REAL': total_calculado_REAL,
                                                                                                                             'total_real_REAL': total_real_REAL,
                                                                                                                              }) 
                                                                                                                  subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/CRS_correctamente_procesado'])
                                                                                                                  print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/CRS_correctamente_procesado", arch_a_extraerle_datos


                                                                                                                  #subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/archivos_procesados/'])
                                                                                                                  #print "moviendo", arch_a_extraerle_datos
                                                                                                  continue
                                                                                            else:
                                                                                                            subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/archivos_en_0/'])
                                                                                                            print "moviendo", arch_a_extraerle_datos
                                                                    print numeros_K
                    return True


### Informacion Importante

    
    name = fields.Char('Nombre de Archivo')
    fecha_archivo = fields.Char('Fecha del Archivo')
    numero_tkt = fields.Char('Numero de TKT')
    
    pnr_localizador = fields.Char('pnr_localizador')
    IssueCode = fields.Char('IssueCode')
    k_in_cmas = fields.Char('k_in_cmas')

    tipo_pasajero = fields.Char('tipo_pasajero')
    numero_pnr = fields.Char('numero_pnr')
    numero_Boleto = fields.Char('numero_Boleto')
    motivo_facturacion_codigo = fields.Char('motivo_facturacion_codigo')
    
    pasajero_principal = fields.Char('pasajero_principal')
    code_emisor = fields.Char('code_emisor')
    numero_motivos = fields.Char('numero_motivos')
    
    
    #nombres= fields.Char('Nombres',size=64 )
    #apellidos= fields.Char('Apellidos',size=64 )
    #titulo= fields.Char('Titulo',size=64 ,  help='Solo debe elegir 1 por ejemplo Ing, Lic u otro, aqui van las 3 letras del titulo universitario obtenido')
    #edad = fields.Integer('Edad')
    total_calculado_REAL  =  fields.Float('total_calculado', digits=(32, 2))
    total_real_REAL =  fields.Float('total_real', digits=(32, 2))

    
    
    pnr_ids = fields.One2many('info_kiu','asociar_pnr_id')

kiu()


class info_kiu(models.Model):
    _name = "info_kiu"
    name = fields.Char('Nombre')
    nombres= fields.Char('Nombres',size=64 )
    numero_Boleto= fields.Char('numero_Boleto',size=64 )
    pasajero_principal = fields.Char('pasajero_principal',size=64 )
    tipo_pasajero = fields.Char('tipo_pasajero',size=64 )
    asociar_pnr_id = fields.Many2one('kiu', required=False)
    
    #Impuestos Desglosados
    tax_6A  =  fields.Char('tax_6A')
    monto_6A  =  fields.Float('monto_6A', digits=(32, 2))
    tax_AJ  =  fields.Char('tax_AJ')
    monto_AJ  =  fields.Float('monto_AJ', digits=(32, 2))
    tax_AK  =  fields.Char('tax_AK')
    monto_AK  =  fields.Float('monto_AK', digits=(32, 2))
    tax_AY  =  fields.Char('tax_AY')
    monto_AY  =  fields.Float('monto_AY', digits=(32, 2))
    tax_US  =  fields.Char('tax_US')
    monto_US  =  fields.Float('monto_US', digits=(32, 2))
    tax_EU  =  fields.Char('tax_EU')
    monto_EU  =  fields.Float('monto_EU', digits=(32, 2))
    tax_VJ  =  fields.Char('tax_VJ')
    monto_VJ  =  fields.Float('monto_VJ', digits=(32, 2))
    tax_XA  =  fields.Char('tax_XA')
    monto_XA  =  fields.Float('monto_XA', digits=(32, 2))
    tax_XY  =  fields.Char('tax_XY')
    monto_XY  =  fields.Float('monto_XY', digits=(32, 2))
    tax_YC  =  fields.Char('tax_YC')
    monto_YC  =  fields.Float('monto_YC', digits=(32, 2))
    tax_XF  =  fields.Char('tax_XF')
    monto_XF  =  fields.Float('monto_XF', digits=(32, 2))
    tax_YQ  =  fields.Char('tax_YQ')
    monto_YQ  =  fields.Float('monto_YQ', digits=(32, 2))
    tax_YN  =  fields.Char('tax_YN')
    monto_YN  =  fields.Float('monto_YN', digits=(32, 2))
    tax_QC  =  fields.Char('tax_QC')
    monto_QC  =  fields.Float('monto_QC', digits=(32, 2))
    tax_Y1C  =  fields.Char('tax_Y1C')
    monto_Y1C  =  fields.Float('monto_Y1C', digits=(32, 2))
    tax_X1Y  =  fields.Char('tax_X1Y')
    monto_X1Y  =  fields.Float('monto_X1Y', digits=(32, 2))
    
    
    #Montos

    sumatoria_desglosados  =  fields.Float('sumatoria_desglosados', digits=(32, 2))
    monto_de_otros_TAX  =  fields.Float('monto_de_otros_TAX', digits=(32, 2))
    total_calculado  =  fields.Float('total_calculado', digits=(32, 2))
    total_real  =  fields.Float('total_real', digits=(32, 2))
    total_CMAS  =  fields.Float('total_CMAS', digits=(32, 2))
    
    monto_tax_2  =  fields.Float('monto_tax_2', digits=(32, 2))
    monto_tax_1  =  fields.Float('monto_tax_1', digits=(32, 2))
    monto_en_moneda  =  fields.Float('monto_en_moneda', digits=(32, 2))

                                                                                                                  

info_kiu()


class intermedio_kiu(models.Model):
    _name = "intermedio_kiu"
    
    
    def create_intermedio_kiu(self, cr, uid, context=None):
        print " Pasar Boletos Con Saldos Correctos  "

        account_Boletos_search = self.pool.get('info_kiu').search(cr, uid, [])   
        account_Boletos_obj = self.pool.get('info_kiu') 
        
        
        nro_iteracion = 0
        for boleto_id in account_Boletos_search: 
                 if nro_iteracion < 3:
                        
                        boleto_id =account_Boletos_obj.browse(cr, uid,boleto_id ,context=context)
                        print boleto_id.pasajero_principal, "nombre_partnernombre_partnernombre_partnernombre_partnernombre_partnernombre_partnernombre_partner"

                        #account_id = self.pool.get('account.account').search(cr,uid,[('code', '=', '101300'),],context=context)
                        #print account_id[0], "account_id"
                        
                        if (boleto_id.total_calculado == 0.00) and (boleto_id.total_real == 0.00):
                                        continue
                        
                        if boleto_id.total_calculado == boleto_id.total_real:
                                 print "Son Iguales", boleto_id.total_calculado,  boleto_id.total_real
                                 class_factura = self.pool.get('account.invoice')
                                 class_product = self.pool.get('product.template')
                                 class_tax = self.pool.get('account.tax')
                                 class_tax_ids = self.pool.get('account.invoice.tax_line_ids')
                                 valores_invoice = {}
                                 lista_tuplas_pasajes_inv = []
                                 nombre_producto = boleto_id.name
                                 monto_en_moneda = boleto_id.monto_en_moneda
                                 if class_product.search(cr,uid,[('name', '=', nombre_producto),],context=context):
                                                 continue
                                 else:
                                                 
                                                 
                                                 
                                                 
                                        
                                        print "nombre_producto",nombre_producto                                               
                                        print "nombre_producto",nombre_producto        
                                        
                                        BB = boleto_id
                                        
                                        lista_taxes_nombres = [
                                                        'amount_YQ', 
                                                         'amount_YC',
                                                         'amount_US ', 
                                                         'amount_XA ',
                                                         'amount_XY',
                                                         'amount_VJ',
                                                         'amount_EU',
                                                         'amount_XF',
                                                         'amount_AY',
                                                         'amount_AJ',
                                                         'amount_YN',
                                                         'amount_AK',
                                                         'amount_QC '
                                                         'amount_6A '
                                                        

                                                         ]
                        
    
    
                                        
                                        
                                        iterar_taxes = 0
                                        tax_ids = []
                                        diccionario_tax = {}
                                        lista111 =[]
                                        lista_tuplas_itinerario =[]
                                        for tax_name in lista_taxes_nombres:
                                                        amount_YQ = BB.monto_YQ
                                                        amount_YC = BB.monto_YC
                                                        amount_US = BB.monto_US
                                                        amount_XA = BB.monto_XA
                                                        amount_XY = BB.monto_XY
                                                        amount_VJ = BB.monto_VJ
                                                        amount_EU = BB.monto_EU
                                                        amount_XF = BB.monto_XF
                                                        amount_AY = BB.monto_AY
                                                        amount_AJ = BB.monto_AJ
                                                        amount_YN = BB.monto_YN
                                                        amount_AK = BB.monto_AK
                                                        amount_QC = BB.monto_QC
                                                        amount_6A = BB.monto_6A
                                                        
                                                        if iterar_taxes == 0:
                                                                  if amount_YQ == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YQ"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YQ)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '251101'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount_YQ,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                        elif iterar_taxes == 1:
                                                                  if amount_YC == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YC"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YC)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '251201'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 2:
                                                                  if amount_US == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_US"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_US)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '251301'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                        
                                                        elif iterar_taxes == 3:
                                                                  if amount_XA == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_XA"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_XA)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2514'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 4:
                                                                  if amount_XY == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_XY"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_XY)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2515'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                             
                                                       
                                                                                                 
                                                        elif iterar_taxes == 5:
                                                                  if amount_VJ == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_VJ"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_VJ)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2517'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                          
                                                                                                 
                                                        elif iterar_taxes == 6:
                                                                  if amount_EU == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_EU euuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuUUU"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_EU)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2518'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                          
                                                        elif iterar_taxes == 7:
                                                                  if amount_XF == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_XF"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_XF)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2520'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                                                                        
                                                        elif iterar_taxes == 8:
                                                                  if amount_AY == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AY"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AY)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2521'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                        elif iterar_taxes == 9:
                                                                  if amount_AJ == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AJ"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AJ)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2522'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                                                 
                                                        elif iterar_taxes == 10:
                                                                  if amount_YN == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YN"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YN)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2523'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 11:
                                                                  if amount_AK == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AK"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AK)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2524'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 
                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                         
                                                                                                                  
                                                        elif iterar_taxes == 12:
                                                                  if amount_QC == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000  #########       QQQQQCCCCCCCCCCCCCCCC  #########"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_QC ##################       QQQQQCCCCCCCCCCCCCCCC  ####################"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_QC)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2525'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 
                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                         
                                                                                                                  
                                                        elif iterar_taxes == 13:
                                                                  if amount_6A == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000  #########       QQQQQCCCCCCCCCCCCCCCC  #########"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_6A ##################       QQQQQCCCCCCCCCCCCCCCC  ####################"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_6A)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2525'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 
                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                        
                                                                        
                                                        class_tax = self.pool.get('account.tax')  
                                                        buscar_tax = self.pool.get('account.tax').search(cr,uid,[('name', '=', name_tax),],context=context)
                                                        if buscar_tax:
                                                                        id_tax_a_cambiar = buscar_tax[0]
                                                                        tax_idssss = class_tax.write(cr, 1, [id_tax_a_cambiar], {'amount': amount})
                                                        else:
                                                                        tax_idssss = class_tax.create(cr,uid, diccionario_tax)
                                                                        buscar_tax = self.pool.get('account.tax').search(cr,uid,[('name', '=', name_tax),],context=context)
                                                                        id_tax_a_cambiar = buscar_tax[0]
                                                                        
                                                        iterar_taxes += 1
                                                                                     
                                                                        
                                                                     
                                                        
                                                        
                                                                        
                                        class_product = self.pool.get('product.product')
             

                                        class_product.create(cr,uid, {'name': nombre_producto, 'list_price': monto_en_moneda , 'type':'service'  , 'taxes_id' : [(6, 0, lista111)], 'supplier_taxes_id' : [(6, 0, lista111)] })
                                        
                                        clase_producto = self.pool.get('product.product').search(cr,uid,[('name', '=', nombre_producto),],context=context)
                                        
                                        id_producto = clase_producto[0]
                                        
                                        
                                        ### PARTNER
                                       
                                        nombre_partner  =   boleto_id.pasajero_principal
                                        tipo_pasajero  =   boleto_id.tipo_pasajero
                                        
                                        print nombre_partner,tipo_pasajero, "nombre_partnernombre_partnernombre_partnernombre_partnernombre_partnernombre_partnernombre_partner"
                                    
                                        class_obj_partner = self.pool.get('res.partner')

                                        clase_res_partner = self.pool.get('res.partner').search(cr,uid,[('name', '=', nombre_partner),],context=context)
                                    
           
                                        data6 = {
                                                         'name' : nombre_partner

                                               }
                                    
                                        if clase_res_partner:
                                                    
                                                     id_cliente = clase_res_partner[0]

                                        else:
                                                     print nombre_partner
                                                    
                                                     class_obj_partner.create(cr,uid, data6)
                          
                                                     clase_res_partner = self.pool.get('res.partner').search(cr,uid,[('name', '=', nombre_partner),],context=context)
                                                     id_cliente = clase_res_partner[0]
                                        
                                        
                                        
                                        
                                        print "id_producto", id_producto 
                                        print lista_tuplas_itinerario
                                        
                                        buscar_code = self.pool.get('account.account').search(cr,uid,[('code', '=', '101200'),],context=context)
                                        account_id = buscar_code[0]
                                        
                                        valores_invoice["partner_id"] = id_cliente
                                        
                                        valores_invoice["name"] = nombre_producto
                                        
                                        valores_invoice["journal_id"] = '1'
                                        
                                        valores_invoice["account_id"] = account_id
                                        nro_tax = len(lista_tuplas_itinerario)
                                        if nro_tax == 0:
                                                        pass
                                        elif nro_tax >= 1:
                                                        valores_invoice["tax_line_ids"] = lista_tuplas_itinerario
                                        
                                        invoice_id = class_factura.create(cr,uid, valores_invoice)
                                        
                                        
                                        self.pool.get('account.invoice.line').create(cr, uid,{
                                                                   'invoice_id' : invoice_id,
                                                                   'name' : nombre_producto,
                                                                   'product_id' : id_producto,
                                                                   'price_unit':  monto_en_moneda,
                                                                   'account_id':  account_id,
                                                                    'invoice_line_tax_eds' : (6, id , lista_tuplas_itinerario ) ,
                                                                    #'account_analytic_id': account_analytic_id,
                                                                    })
                                        
                                        
                                        
                                        inv_obj = self.pool.get('account.invoice')
                                        inv_obj.action_date_assign(cr, uid, invoice_id, context=context)
                                        inv_obj.action_move_create(cr, uid, invoice_id, context=context)
                                        inv_obj.invoice_validate(cr, uid, invoice_id, context=context)
                                        
                                        invoice_ids = [(4,[invoice_id])]
                                        amount = BB.total_real
                                        
                                        journal_search = self.pool.get('account.journal').search(cr,uid,[('name', '=', 'Cash'),],context=context)
                                        journal_id = journal_search[0]
                                        #pago_id = self.pool.get('account.payment').create(cr, uid,{
                                                                   #'partner_id' : id_cliente,
                                                                   #'journal_id' : journal_id,
                                                                   #'currency_id' : "3",
                                                                   #'partner_type' : 'customer',
                                                                   #'payment_type':  'inbound',
                                                                   ##'invoice_ids':  invoice_ids,
                                                                   #'payment_method_id':  '1',
                                                                   #'amount':  amount,
                                                                   ##'state':  'posted',
                                                                   
                                                                    ##'taxes_id' : (6, id , lista111 ) ,
                                                                    ##'account_analytic_id': account_analytic_id,
                                                                    #})
                                        
                                        #pago =  self.pool.get('account.payment')
                                        #pago.post(cr, uid, pago_id, context=context)
                                        #inv_obj.write(cr, 1, [invoice_id], {'state': 'paid'})
                                        
                                        
                                        nro_iteracion += 1

                                        
                                        
    
    
    name = fields.Char('Nombre')
    nombres= fields.Char('Nombres',size=64 )
    
    #asociar_pnr_id = fields.Many2one('cintas_cat', required=False)
    
                                                                                                        
                                                                                                            
    tipo_pasajero= fields.Char('tipo_pasajero',size=64 )
    pasajero= fields.Char('pasajero',size=64 )

    #Impuestos Desglosados
    amount_YQ  =  fields.Float('amount_YQ', digits=(32, 2))
    amount_YC  =  fields.Float('amount_YC', digits=(32, 2))
    amount_US  =  fields.Float('amount_US', digits=(32, 2))
    amount_XA  =  fields.Float('amount_XA', digits=(32, 2))
    amount_XY  =  fields.Float('amount_XY', digits=(32, 2))
    amount_AW  =  fields.Float('amount_AW', digits=(32, 2))
    amount_VJ  =  fields.Float('amount_VJ', digits=(32, 2))
    amount_EU  =  fields.Float('amount_EU', digits=(32, 2))
    amount_YR  =  fields.Float('amount_YR', digits=(32, 2))
    amount_XF  =  fields.Float('amount_XF', digits=(32, 2))
    amount_AY  =  fields.Float('amount_AY', digits=(32, 2))
    amount_AJ  =  fields.Float('amount_AJ', digits=(32, 2))
    amount_YN  =  fields.Float('amount_YN', digits=(32, 2))
    amount_AK  =  fields.Float('amount_AK', digits=(32, 2))
    amount_QC  =  fields.Float('amount_QC', digits=(32, 2))

    numero_Boleto = fields.Char('numero_Boleto')
    
    #Montos

    sumatoria_desglosados  =  fields.Float('sumatoria_desglosados', digits=(32, 2))
    monto_de_otros_TAX  =  fields.Float('monto_de_otros_TAX', digits=(32, 2))
    total_calculado  =  fields.Float('total_calculado', digits=(32, 2))
    total_real  =  fields.Float('total_real', digits=(32, 2))
    total_CAT  =  fields.Float('total_CAT', digits=(32, 2))
    
    monto_tax_2  =  fields.Float('monto_tax_2', digits=(32, 2))
    monto_tax_1  =  fields.Float('monto_tax_1', digits=(32, 2))
    monto_en_moneda  =  fields.Float('monto_en_moneda', digits=(32, 2))

                                                                                                                  

intermedio_kiu()




class cintas_cat(models.Model):
    _name = "cintas_cat"
    

     
  
    def create_cat(self, cr, uid, context=None):
                    os.system("ls /home/odoo/archivos_kiu/CAT_descomprimidos  > /home/odoo/archivos_kiu/CAT_descomprimidos.txt")
   
   
                    archivo_CAT ='/home/odoo/archivos_kiu/CAT_descomprimidos.txt'
                    archi_CAT = open(archivo_CAT,'r') 
                    class_cat_obj = self.pool.get('cintas_cat') 
                    class_boletos_cat = self.pool.get('info_cintas_cat') 
                    class_PNR_en_CAT = self.pool.get('cintas_cat') 
                    
                    for archivo_cat_a_extraer in archi_CAT:
                                    #arch_a_extraerle_datos = '/home/odoo/archivos_kiu/CAT/'+archivo_cat_a_extraer
                                    arch_a_extraerle_datos = '/home/odoo/archivos_kiu/CAT_descomprimidos/'+archivo_cat_a_extraer
                                    
                                    
                                    arch_a_extraerle_datos = arch_a_extraerle_datos.strip()
                
                                    if archivo_cat_a_extraer:
                                             
                                                                    archivo = arch_a_extraerle_datos
                                                                    reader= open(archivo, 'r')
                                                                    cantidad_archivos  =  0
                                                                    list_total_calculado_REAL = []
                                                                    list_total_real_REAL = []
                                                                    lista_tuplas_boleto = []
                                                                    numeros_K = 0
                                                                    
                                                                    for line in reader: 
                                                         
                                                                                  if line[0:3] == 'TTH':
                                                                                                 
                                                                                                  #print "TTH 3"
                                                                                                  pass
                                                                                                  #print line
                                                                              
                                                                                  if line[0:3] == 'TKT':
                                                                                                  lista_amount_taxes = []
                                                                                                  lista_amount_taxes_con_con = []
                                                                                                  lista_amount_sin_replace = []
                                                                                                  lista_taxes = []
                                                                                                  lista_total_real = []
                                                                                                  
                                                                                                  lista_amount_YQ = []
                                                                                                  lista_amount_YC = []
                                                                                                  lista_amount_US = []
                                                                                                  lista_amount_XA = []
                                                                                                  lista_amount_XY = []
                                                                                                  lista_amount_AW = []
                                                                                                  lista_amount_VJ = []
                                                                                                  lista_amount_EU = []
                                                                                                  lista_amount_YR = []
                                                                                                  lista_amount_XF = []
                                                                                                  lista_amount_AY = []
                                                                                                  lista_amount_AJ = []
                                                                                                  lista_amount_YN = []
                                                                                                  lista_amount_AK = []
                                                                                                  lista_amount_QC = []
                                                                                                  
                                                                                                  amount_amount = 0
                                                                                              
                                                                                  if line[0:3] == 'TOH':
                                                                                                  pass
                                                                                                  #print "TOH 3"
                                                                                                  #print line
                                                                                  if line[0:3] == 'TKS':
                                                                                                  #print "TKS 3"
                                                                                                  #print line
                                                                                                  if line[41:44] == "001":
                                                                                                                  
                                                                                                                  
                                                                                                                  pasajero = line[44:84]
                                                                                                                  pasajero = pasajero.strip() 
                                                                                                                  if pasajero[-3:] == "CHD":
                                                                                                                                  tipo_pasajero = "CHD"
                                                                                                                                  pasajero = pasajero.replace("CHD"," ")
                                                                                                                  else: 
                                                                                                                                  tipo_pasajero = 'NON'
                                                                                                                  pasajero = pasajero.strip()                
                                                                                                                  print pasajero
                                                                                                  
                                                                                       
                                                                                                  lista_impuestos = ['YQ ', 'YC ',"US  ","XA ", "XY " , "AW ","VJ ","EU ","YR ","XF ","AY  ", "AJ " , "YN ", "AK ", "QC "]
                                                                                                  
                                                                                                  for impuesto in lista_impuestos:
                                                                                                                  
                                                                                                                  search_tax = line.find(impuesto)
                                                                                                                  search_tax_83 = line[83:85]
                                                                                                                  search_tax_83 = search_tax_83+" "
                                                                                                                  if  "US " == search_tax_83:
                                                                                                                                  search_tax_83 = "US "+" "
                                                                                                                  if  "AY " == search_tax_83:
                                                                                                                                  search_tax_83 = "AY "+" "
                                                                                                                                  

                                                                                                                  
                                                                                                                  search_tax_64 = line[64:66]
                                                                                                                  search_tax_64 = search_tax_64+" "
                                                                                                                  if  "US " == search_tax_64:
                                                                                                                                  search_tax_64 = "US "+" "
                                                                                                                  if  "AY " == search_tax_64:
                                                                                                                                  search_tax_64 = "AY "+" "
                                                                                                                  
                                                                                                                  
                                                                                                                  if search_tax_83 != -1 or search_tax_64 != -1:
                                                                                                                                  
                                                                                                                                  
                                                                                                                                  #print search_tax
                                                                                                                                  tipo_tax = line[search_tax:search_tax+2]
                                                                                                                                  amount_tax = line[search_tax+2:search_tax+19]
                                                                                                                                  amount_tax_con_con =  line[search_tax+2:search_tax+19]

                                                                                                                                  amount_tax = amount_tax.replace('E', '5')
                                                                                                                                  amount_tax = amount_tax.replace('F', '6')
                                                                                                                                  amount_tax = amount_tax.replace('{', '0') 
                                                                                                                                  ###PUEDE SER
                                                                                                                                  amount_tax = amount_tax.replace('D', '4') 
                                                                                                                                  amount_tax = amount_tax.replace('A', '1') 
                                                                                                                                  ### Corregir
                                                                                                                                  amount_tax = amount_tax.replace('I', '2') 
                                                                                                                                  amount_tax = amount_tax.replace('G', '8') 
                                                                                                                                  amount_tax = amount_tax.replace('C', '1') 
                                                                                                                                  amount_tax = amount_tax.replace('H', '3') 
                                                                                                                                  
                      
                                                                                                                                  amount_tax = amount_tax[-5:-2]+'.'+amount_tax[-2:]
                                                                                                                                  if amount_tax[-1] == "A" or amount_tax[-1] == "B":
                                                                                                                                                  #print "CAMBIANDO"
                                                                                                                                                  amount_tax = amount_tax[0:-1]
                                                                                                                                                  #print amount_tax
                                                                                                                                                  
                                                                                                                                  amount_tax = float(amount_tax) * 1.0000
                                                                                                                                                  
                                                                                                                                                  
                                                                                                                  if search_tax_83 == impuesto:
                                                                                                                                  #print line
                                                                                                                                  lista_amount_taxes_con_con.append(amount_tax_con_con)
                                                                                                                                                  
                                                                                                                                  lista_amount_taxes.append(amount_tax)
                                                                                                                                  lista_taxes.append(impuesto)
                                                                                                                                  #print "-------------------------------------------------------------->      ",tipo_tax,"  ---->", amount_tax
                                                                                                                  
                                                                                                                  
                                                                                                                  
                                                                                                           
                                                                                                                  
                                                                                                                                  if impuesto == 'YQ ':
                                                                                                                                                  
                                                                                                                                                  amount_YQ = amount_tax
                                                                                                                                                  lista_amount_YQ.append(amount_tax)
                                                                                                                                                  
                                                                                                                                               
                                                                                                                                  if impuesto == "QC ":
                                                                                                                                                  
                                                                                                                                                  amount_QC = amount_tax
                                                                                                                                                  lista_amount_QC.append(amount_tax)
                                                                                                                                                  
                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YC ':
                                                                                                                                                  amount_YC = amount_tax
                                                                                                                                                  lista_amount_YC.append(amount_tax)
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'US  ':
                                                                                                                                                  amount_US = amount_tax
                                                                                                                                                             
                                                                                                                                                  lista_amount_US.append(amount_tax)
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XA ':
                                                                                                                                                  amount_XA = amount_tax
                                                                                                                                                         
                                                                                                                                                  lista_amount_XA.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                                             
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XY ':
                                                                                                                                                  amount_XY = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_XY.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AW ':
                                                                                                                                                  amount_AW = amount_tax
                                                                                                                                                                  
                                                                                                                                                  lista_amount_AW.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                  elif impuesto == 'VJ ':
                                                                                                                                                  amount_VJ = amount_tax
                                                                                                                                                         
                                                                                                                                                  lista_amount_VJ.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                                 
                                                                                                                                                    
                                                                                                                                  elif impuesto == 'EU ':
                                                                                                                                                  amount_EU = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_EU.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YR ':
                                                                                                                                                  amount_YR = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_YR.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XF ':
                                                                                                                                                  amount_XF = amount_tax
                                                                                                                                                         
                                                                                                                                                  lista_amount_XF.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AY  ':
                                                                                                                                                  amount_AY = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_AY.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AJ ':
                                                                                                                                                  amount_AJ = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_AJ.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YN ':
                                                                                                                                                  amount_YN = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_YN.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AK ':
                                                                                                                                                  amount_AK = amount_tax
                                                                                                                                                                  
                                                                                                                                                  lista_amount_AK.append(amount_tax)
                                                                                                                                                             
                                                                                                                                                                                 
                                                                                                                                  elif impuesto == 'QC ':
                                                                                                                                                  amount_QC = amount_tax
                                                                                                                                                                  
                                                                                                                                                  lista_amount_QC.append(amount_tax)
                                                                                                                                                             
                                                                                                                                                                        
                                                                                                                                                                  
                                                                                                                                                                                 
                                                                                                                                                                  
                                                                                                            
                                                                                                                  if search_tax_64 == impuesto:
                                                                                                                                 
                                                                                                                                  #print line
                                                                                                                                  lista_amount_taxes_con_con.append(amount_tax_con_con)
                                                                                                                                  lista_amount_taxes.append(amount_tax)
                                                                                                                                  lista_taxes.append(impuesto)
                                                                                                                                  #print "-------------------------------------------------------------->      ",tipo_tax,"  ---->", amount_tax
                                                                                                                  
                                                                                                                                  
                                                                                                                                  
                                                                                                                                  
                                                                                                                                  if impuesto == 'YQ ':
                                                                                                                                                  
                                                                                                                                                  amount_YQ = amount_tax
                                                                                                                                                  lista_amount_YQ.append(amount_tax)
                                                                                                                                                  
                                                                                                                                               
                                                                                                                                  if impuesto == "QC ":
                                                                                                                                                  
                                                                                                                                                  amount_QC = amount_tax
                                                                                                                                                  lista_amount_QC.append(amount_tax)
                                                                                                                                                  
                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YC ':
                                                                                                                                                  amount_YC = amount_tax
                                                                                                                                                  lista_amount_YC.append(amount_tax)
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'US  ':
                                                                                                                                                  amount_US = amount_tax
                                                                                                                                                             
                                                                                                                                                  lista_amount_US.append(amount_tax)
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XA ':
                                                                                                                                                  amount_XA = amount_tax
                                                                                                                                                         
                                                                                                                                                  lista_amount_XA.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                                             
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XY ':
                                                                                                                                                  amount_XY = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_XY.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AW ':
                                                                                                                                                  amount_AW = amount_tax
                                                                                                                                                                  
                                                                                                                                                  lista_amount_AW.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                  elif impuesto == 'VJ ':
                                                                                                                                                  amount_VJ = amount_tax
                                                                                                                                                         
                                                                                                                                                  lista_amount_VJ.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                                 
                                                                                                                                                    
                                                                                                                                  elif impuesto == 'EU ':
                                                                                                                                                  amount_EU = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_EU.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YR ':
                                                                                                                                                  amount_YR = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_YR.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XF ':
                                                                                                                                                  amount_XF = amount_tax
                                                                                                                                                         
                                                                                                                                                  lista_amount_XF.append(amount_tax)
                                                                                                                                                                      
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AY  ':
                                                                                                                                                  amount_AY = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_AY.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AJ ':
                                                                                                                                                  amount_AJ = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_AJ.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YN ':
                                                                                                                                                  amount_YN = amount_tax
                                                                                                                                                          
                                                                                                                                                  lista_amount_YN.append(amount_tax)
                                                                                                                                                                     
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AK ':
                                                                                                                                                  amount_AK = amount_tax
                                                                                                                                                                  
                                                                                                                                                  lista_amount_AK.append(amount_tax)
                                                                                                                                                             
                                                                                                                                                                        
                                                                                                                                                                  
                                                                                                                                                                             
                                                                                                                                  elif impuesto == 'QC ':
                                                                                                                                                  amount_QC = amount_tax
                                                                                                                                                                  
                                                                                                                                                  lista_amount_QC.append(amount_tax)
                                                                                                                                                             
                                                                                                                                                                        
                                                                                                                                                                  
                                                                                                                                                                        
                                                                                                                                                                  
                                                                                                            
                                                                                                                  else:
                                                                                                                  
                                                                                                                                  if impuesto == 'YQ ':
                                                                                                                                                  
                                                                                                                                                  amount_YQ = 0.00
                                                                                                                                               
                                                                                                                                                  
                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YC ':
                                                                                                                                                  amount_YC = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'US  ':
                                                                                                                                                  amount_US = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XA ':
                                                                                                                                                  amount_XA = 0.00
                                                                                                                                                                  
                                                                                                                                                             
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XY ':
                                                                                                                                                  amount_XY = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AW ':
                                                                                                                                                  amount_AW = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'VJ ':
                                                                                                                                                  amount_VJ = 0.00
                                                                                                                                                                  
                                                                                                                                                 
                                                                                                                                                    
                                                                                                                                  elif impuesto == 'EU ':
                                                                                                                                                  amount_EU = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YR ':
                                                                                                                                                  amount_YR = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'XF ':
                                                                                                                                                  amount_XF = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AY  ':
                                                                                                                                                  amount_AY = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AJ ':
                                                                                                                                                  amount_AJ = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'YN ':
                                                                                                                                                  amount_YN = 0.00
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'AK ':
                                                                                                                                                  amount_AK = 0.00
                                                                                                                                                                  
                                                                                                                                                 
                                                                                                                                                                                  
                                                                                                                                  elif impuesto == 'QC ':
                                                                                                                                                  amount_QC = 0.00
                                                                                                                                                                  
                                                                                                                                                 
                                                                                                                                                                        
                                                                                                                                                
                                                                                                                  
                                                                                                                  
                                                                                                                  
                                                                                                                  
                                                                                                                  
                                                                                    
                                                                             
                                                                              
                                                                                  if line[0:3] == 'TCT':
                                                                                                  #print "TCT 3"
                                                                                                  pass
                                                                                                  #print line  
                                                                                                  
                                                                                  
                                                                             
                                                                              
                                                                                  if line[0:3] == 'TKI':
                                                                                                  #print "TKI 3"
                                                                                                  pass
                                                                                                  #print line   
                                                                                                  
                                                                                                  
                                                                                                  #print "algo?????? MIA", line.find("MIA")
                                                                                                  #print "algo?????? AUA", line.find("AUA")
                                                                                                  
                                                                                 
                                                                                            

                                                                                              
                                                                                                     
                                                                                  if line[0:3] == 'TKF':
                                                                                                  #print "TKF 3"
                                                                                                  pass
                                                                                                  #print line
                                                                                 
                                                                              
                                                                                                  boleto = line[25:40]
                                                                                                  #print "boleto", line.find("NUC110.00")
                                                                                                  
                                                                                                  
                                                                                                  #print "CALCULO EQUIVFARE"
                                                                                                  if line.find("END") != -1 and line.find("NUC") != -1:
                                                                                                                  #print "VER LINEA"
                                                                                                                  #print line
                                                                                                                  s_NUC = line.find("NUC")
                                                                                                                  s_END = line.find("END")
                                                                                                                  TOTAL_EquivFare = line[s_NUC+3:s_END]
                                                                                                                  TOTAL_EquivFare = TOTAL_EquivFare.strip()
                                                                                                                  #print TOTAL_EquivFare , "TOTAL_EquivFare"
                                                                              
                                                                                                  elif line.find("END") != -1 and line.find("USD") != -1:
                                                                                                                  #print "VER LINEA"
                                                                                                                  #print line
                                                                                                                  s_NUC = line.find("USD")
                                                                                                                  s_END = line.find("END")
                                                                                                                  TOTAL_EquivFare = line[s_NUC+3:s_END]
                                                                                                                  TOTAL_EquivFare = TOTAL_EquivFare.strip()
                                                                                                                  #print TOTAL_EquivFare , "TOTAL_EquivFare"
                                                                              
                                                                                  if line[0:3] == 'TKP':
                                                                                                  
                                                                                                  #print "TKP 3"
                                                                                                  #print line
                                                                                                  
                                                                                                  #print line.find('  ')
                                                                                                  TOTAL_REAL_1 =  line[33:46]
                                                                                                  TOTAL_REAL =  line[33:46]
                                                                                                  
                                                                                                  
                                                                                                  #print TOTAL_REAL, " SIN REPLACE    TOTAL_REAL"
                                                                                                  
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('E', '5')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('F', '6') 
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('{', '0')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('D', '4')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('C', '3')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('G', '8')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('H', '1')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('B', '7')
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('I', '2') 
                                                                                                  TOTAL_REAL = TOTAL_REAL.replace('A', '1') 
                                                                                                  TOTAL_REAL = TOTAL_REAL[0:-2] + "." + TOTAL_REAL[-2:]
                                                                                                  TOTAL_REAL_real = float(TOTAL_REAL)
                                                                                                            
                                                                                                  
                                                                                                  #print TOTAL_REAL, "TOTAL_REAL"
                                                                                                  
                                                                                                  #print lista_amount_taxes
                                                                                                  #print lista_amount_sin_replace , "lista_amount_sin_replace "

                                                                                                  TOTAL_EquivFare = float(TOTAL_EquivFare)
                                                                                                  TOTAL_CALCULADO_TAX = sum(lista_amount_taxes)

                                                                                                  
                                                                                                  print  TOTAL_EquivFare, TOTAL_CALCULADO_TAX
                                                                                                  
                                                                                                  TOTAL_CALCULADO = TOTAL_CALCULADO_TAX + TOTAL_EquivFare
                                                                                                  TOTAL_CALCULADO = round(TOTAL_CALCULADO, 2)
                                                                                                  print  TOTAL_REAL_real, TOTAL_CALCULADO
                                                                                                  
                                                                                                  #print "TOTAL_CALCULADO_TAX", TOTAL_CALCULADO
                                                                                                  if TOTAL_REAL_real == TOTAL_CALCULADO:
                                                                                                               #print "############################################"
                                                                                                               #print boleto
                                                                                                               #print TOTAL_REAL == TOTAL_CALCULADO
                                                                                                               #print "TOTAL_CALCULADO_TAX", TOTAL_CALCULADO
                                                                                                               #print "TOTAL_REAL", TOTAL_REAL
                                                                                                               #print "      "
                                                                                                               #print "      "
                                                                                                               pass
                                                                                                               
                                                                                                               
                                                                                                  else:
                                                                                                               print "############################################"
                                                                                                               print "############################################"
                                                                                                               print "############################################"
                                                                                                               print "############################################"
                                                                                                               print boleto
                                                                                                               print TOTAL_REAL == TOTAL_CALCULADO
                                                                                                               print "TOTAL_CALCULADO_TAX", TOTAL_CALCULADO
                                                                                                               print "TOTAL_REAL", TOTAL_REAL_1
                                                                                                               print "TOTAL_REAL", TOTAL_REAL_real
                                                                                                               print "amount_YQ", amount_YQ
                                                                                                               
                                                                                                               print "lista_amount_taxes", lista_amount_taxes
                                                                                                               print "lista_amount_taxes", lista_amount_taxes_con_con
                                                                                                               print "      "
                                                                                                               
                                                                                                               print "--------------------->>>>>>>>>>>>>>>>>>>>>>>>>>><", lista_amount_YQ
                                                                                                                
                                                                                                  if lista_amount_YQ:
                                                                                                                  amount_YQ = lista_amount_YQ[0]
                                                                                                   
                                                                                                  else:
                                                                                                                  amount_YQ = 0.00
                                                                                                                  
                                                                                                                  
                                                                                                                  
                                                                                                  if lista_amount_YC:
                                                                                                                  amount_YC = lista_amount_YC[0]
                                                                                                   
                                                                                                  else:
                                                                                                                  amount_YC = 0.00
                                                                                                                  
                                                                                                                  
                                                                                                  if lista_amount_US:
                                                                                                                  amount_US = lista_amount_US[0]
                                                                                                   
                                                                                                  else:
                                                                                                                  amount_US = 0.00
                                                                                                                  
                                                                                                  if lista_amount_XA:
                                                                                                                  amount_XA = lista_amount_XA[0]
                                                                                                             
                                                                                                  else:
                                                                                                                  amount_XA = 0.00
                                                                                                                  
                                                                                                                  
                                                                                                  if lista_amount_XY:
                                                                                                                  amount_XY = lista_amount_XY[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_XY = 0.00
                                                                                                                  
                                                                                                  if lista_amount_AW:
                                                                                                                  amount_AW = lista_amount_AW[0]
                                                                                                                  
                                                                                                  else:
                                                                                                                  amount_AW = 0.00
                                                                                                                  
                                                                                                  if lista_amount_VJ:
                                                                                                                  amount_VJ = lista_amount_VJ[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_VJ = 0.00
                                                                                                                  
                                                                                                  if lista_amount_EU:
                                                                                                                  amount_EU = lista_amount_EU[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_EU = 0.00
                                                                                                                  
                                                                                                  if lista_amount_YR:
                                                                                                                  amount_YR = lista_amount_YR[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_YR = 0.00
                                                                                                                  
                                                                                                  if lista_amount_XF:
                                                                                                                  amount_XF = lista_amount_XF[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_XF = 0.00
                                                                                                                  
                                                                                                  if lista_amount_AY:
                                                                                                                  amount_AY = lista_amount_AY[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_AY = 0.00
                                                                                                                  
                                                                                                  if lista_amount_AJ:
                                                                                                                  amount_AJ = lista_amount_AJ[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_AJ = 0.00
                                                                                                                  
                                                                                                  if lista_amount_YN:
                                                                                                                  amount_YN = lista_amount_YN[0]
                                                                                                                   
                                                                                                  else:
                                                                                                                  amount_YN = 0.00
                                                                                                                  
                                                                                                  if lista_amount_AK:
                                                                                                                  amount_AK = lista_amount_AK[0]
                                                                                                                        
                                                                                                  else:
                                                                                                                  amount_AK = 0.00           
                                                                                                  if lista_amount_QC:
                                                                                                                  amount_QC = lista_amount_QC[0]
                                                                                                                        
                                                                                                  else:
                                                                                                                  amount_QC = 0.00
                                                                                                                               
                                                                                                  buscar_boleto = class_boletos_cat.search(cr,uid,[('name', '=', archivo_cat_a_extraer),],context=context)                             
                                                                                                  if buscar_boleto:
                                                                                                                  print "YA EXSTE", boleto
                                                                                                                  
                                                                                                  else:
                                                                                                      print  TOTAL_REAL_real, TOTAL_CALCULADO
                                                                                                      print "BOOOOOOOOOOOOOLLLLLLLLLLLLEEEEEEEEEEETTTTTTOOOOOOO", boleto                
                                                                                                      list_total_calculado_REAL.append(TOTAL_CALCULADO)
                                                                                                      list_total_real_REAL.append(TOTAL_REAL_real)
                                                                                                      dict__datos_tkt = {
                                
                                                                                                        'name': boleto,
                                                                                                        'total_real': TOTAL_REAL_real,
                                                                                                        'total_calculado': TOTAL_CALCULADO,
                                                                                                        'monto_en_moneda': TOTAL_EquivFare,
                                                                                                        'pasajero': pasajero,
                                                                                                        'tipo_pasajero': tipo_pasajero,
                                                                                                        'amount_YQ': amount_YQ,
                                                                                                        'amount_YC': amount_YC,
                                                                                                        'amount_US': amount_US,
                                                                                                        'amount_XA': amount_XA,
                                                                                                        'amount_XY': amount_XY,
                                                                                                        'amount_AW': amount_AW,
                                                                                                        'amount_VJ': amount_VJ,
                                                                                                        'amount_EU': amount_EU,
                                                                                                        'amount_YR': amount_YR,
                                                                                                        'amount_XF': amount_XF,
                                                                                                        'amount_AY': amount_AY,
                                                                                                        'amount_AJ': amount_AJ,
                                                                                                        'amount_YN': amount_YN,
                                                                                                        'amount_AK': amount_AK,
                                                                                                        'amount_QC': amount_QC,
                                                                                                                               }
                                                                                                  
                                                                                                  
                                                                                                      tupla_datos_boleto = (0, id, dict__datos_tkt)
                                                                                                      print "                Agregando boleto             ", boleto
                                                                                                      lista_tuplas_boleto.append(tupla_datos_boleto)
                                                                                                      numeros_K += 1              
                                                                                                                                                      
                                                                              
                                                                                  #if line[0:3] == 'TOT':
                                                                                                  
                                                                                                  #print "TOT 3"
                                                                                                  #print line
                                                                                                  #TOTAL_REAL =  line[44:49]
                                                                                                  #TOTAL_REAL = TOTAL_REAL.replace('E', '5')
                                                                                                  #TOTAL_REAL = TOTAL_REAL.replace('F', '6') 
                                                                                                  #TOTAL_REAL = TOTAL_REAL.replace('{', '0')
                                                                                                  #TOTAL_REAL = TOTAL_REAL[0:-2]+'.'+TOTAL_REAL[-2:]
                                                                                                  
                                                                                                  #print TOTAL_REAL, "TOTAL_REAL"
                                                                                                  #TOTAL_EquivFare = float(TOTAL_EquivFare)
                                                                                                  #TOTAL_CALCULADO_TAX = sum(lista_amount_taxes)
                                                                                                  #print lista_amount_taxes
                                                                                                  #print  TOTAL_EquivFare, TOTAL_CALCULADO_TAX
                                                                                                  
                                                                                                  #TOTAL_CALCULADO = TOTAL_CALCULADO_TAX + TOTAL_EquivFare
                                                                                                  
                                                                                                  #print "TOTAL_CALCULADO_TAX", TOTAL_CALCULADO
                                                                            
                                                                                  if line[0:3] == 'TTT':
                                                                                        #if "VE" not in archivo :
                                                                                                  print boleto
                                                                                                  print TOTAL_REAL == TOTAL_CALCULADO
                                                                                                  print "TOTAL_CALCULADO_TAX", TOTAL_CALCULADO
                                                                                                  print "TOTAL_REAL", TOTAL_REAL_1
                                                                                                  print "TOTAL_REAL", TOTAL_REAL_real
                                                                                                               
                                                                                                  class_cat_obj = self.pool.get('cintas_cat') 

                                                                                        
                                                                                                  buscar_cat = self.pool.get('cintas_cat').search(cr,uid,[('name', '=', archivo_cat_a_extraer),],context=context)
                                                                                                  if buscar_cat:
                                                                                                                  print "EXISTE"
                                                                                                                  #subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/archivos_procesados/'])
                                                                                                                  print "moviendo", arch_a_extraerle_datos
                                                                                                  else:
                                                                                                                  print      archivo_cat_a_extraer, "archivo_cat_a_extraer NO EXISTE"
                                                                                                                  
                                                                                                                  total_real_REAL = sum(list_total_real_REAL)
                                                                                                                  
                                                                                                                  total_calculado_REAL = sum(list_total_calculado_REAL)
                                                                                                                  print total_real_REAL, total_calculado_REAL
                                                                                                                  total_real_REAL = float(total_real_REAL)
                                                                                                                  total_calculado_REAL = float(total_calculado_REAL)
                                                                                                                  print total_real_REAL, total_calculado_REAL
                                                                                                                  class_cat_obj.create(cr,uid, {
                                                                                                                         'name': archivo_cat_a_extraer,
                                                                                                                          'nombres': archivo_cat_a_extraer,
                                                                                                                           'boleto_ids': lista_tuplas_boleto,
                                                                                                                            'total_calculado_REAL': total_calculado_REAL,
                                                                                                                             'total_real_REAL': total_real_REAL,
                                                    
                                                                                                                                  }) 
                                                                                                                  subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/CAT_correctamente_procesado'])
                                                                                                                  print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/CAT_correctamente_procesado", arch_a_extraerle_datos



                                                                                                                  #subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/archivos_procesados/'])
                                                                                                                  #print "moviendo", arch_a_extraerle_datos
                                                                                                  continue
                                                                                            
                    return True



### Informacion Importante

    
    name = fields.Char('Nombre de Archivo')
    fecha_archivo = fields.Char('Fecha del Archivo')
    numero_tkt = fields.Char('Numero de TKT')
    
    pnr_localizador = fields.Char('pnr_localizador')
    IssueCode = fields.Char('IssueCode')
    k_in_cat = fields.Char('k_in_cat')

    tipo_pasajero = fields.Char('tipo_pasajero')
    numero_Boleto = fields.Char('numero_Boleto')
    motivo_facturacion_codigo = fields.Char('motivo_facturacion_codigo')
    
    pasajero_principal = fields.Char('pasajero_principal')
    code_emisor = fields.Char('code_emisor')
    numero_motivos = fields.Char('numero_motivos')
    
    
    #nombres= fields.Char('Nombres',size=64 )
    #apellidos= fields.Char('Apellidos',size=64 )
    #titulo= fields.Char('Titulo',size=64 ,  help='Solo debe elegir 1 por ejemplo Ing, Lic u otro, aqui van las 3 letras del titulo universitario obtenido')
    #edad = fields.Integer('Edad')
    total_calculado_REAL  =  fields.Float('total_calculado', digits=(32, 2))
    total_real_REAL =  fields.Float('total_real', digits=(32, 2))

    
    
    boleto_ids = fields.One2many('info_cintas_cat','asociar_pnr_id')

cintas_cat()


class info_cintas_cat(models.Model):
    _name = "info_cintas_cat"
    name = fields.Char('Nombre')
    nombres= fields.Char('Nombres',size=64 )
    
    asociar_pnr_id = fields.Many2one('cintas_cat', required=False)
    
                                                                                                        
                                                                                                            
    tipo_pasajero= fields.Char('tipo_pasajero',size=64 )
    pasajero= fields.Char('pasajero',size=64 )

    #Impuestos Desglosados
    amount_YQ  =  fields.Float('amount_YQ', digits=(32, 2))
    amount_YC  =  fields.Float('amount_YC', digits=(32, 2))
    amount_US  =  fields.Float('amount_US', digits=(32, 2))
    amount_XA  =  fields.Float('amount_XA', digits=(32, 2))
    amount_XY  =  fields.Float('amount_XY', digits=(32, 2))
    amount_AW  =  fields.Float('amount_AW', digits=(32, 2))
    amount_VJ  =  fields.Float('amount_VJ', digits=(32, 2))
    amount_EU  =  fields.Float('amount_EU', digits=(32, 2))
    amount_YR  =  fields.Float('amount_YR', digits=(32, 2))
    amount_XF  =  fields.Float('amount_XF', digits=(32, 2))
    amount_AY  =  fields.Float('amount_AY', digits=(32, 2))
    amount_AJ  =  fields.Float('amount_AJ', digits=(32, 2))
    amount_YN  =  fields.Float('amount_YN', digits=(32, 2))
    amount_AK  =  fields.Float('amount_AK', digits=(32, 2))
    amount_QC  =  fields.Float('amount_QC', digits=(32, 2))

    numero_Boleto = fields.Char('numero_Boleto')
    
    #Montos

    sumatoria_desglosados  =  fields.Float('sumatoria_desglosados', digits=(32, 2))
    monto_de_otros_TAX  =  fields.Float('monto_de_otros_TAX', digits=(32, 2))
    total_calculado  =  fields.Float('total_calculado', digits=(32, 2))
    total_real  =  fields.Float('total_real', digits=(32, 2))
    total_CAT  =  fields.Float('total_CAT', digits=(32, 2))
    
    monto_tax_2  =  fields.Float('monto_tax_2', digits=(32, 2))
    monto_tax_1  =  fields.Float('monto_tax_1', digits=(32, 2))
    monto_en_moneda  =  fields.Float('monto_en_moneda', digits=(32, 2))

                                                                                                                  

info_cintas_cat()



class intermedio_cintas_cat(models.Model):
    _name = "intermedio_cintas_cat"
    
    
    def create_intermedio(self, cr, uid, context=None):
        print " Pasar Boletos Con Saldos Correctos  "

        account_Boletos_search = self.pool.get('info_cintas_cat').search(cr, uid, [])   
        account_Boletos_obj = self.pool.get('info_cintas_cat') 
        
        
        nro_iteracion = 0
        for boleto_id in account_Boletos_search: 
                 if nro_iteracion < 3:
                        
                        boleto_id =account_Boletos_obj.browse(cr, uid,boleto_id ,context=context)
                        #account_id = self.pool.get('account.account').search(cr,uid,[('code', '=', '101300'),],context=context)
                        #print account_id[0], "account_id"
                        if (boleto_id.total_calculado == 0.00) and (boleto_id.total_real == 0.00):
                                        continue
                        if boleto_id.total_calculado == boleto_id.total_real:
                             
                                 print "Son Iguales", boleto_id.total_calculado,  boleto_id.total_real
                                 class_factura = self.pool.get('account.invoice')
                                 class_product = self.pool.get('product.template')
                                 class_tax = self.pool.get('account.tax')
                                 class_tax_ids = self.pool.get('account.invoice.tax_line_ids')
                                 valores_invoice = {}
                                 lista_tuplas_pasajes_inv = []
                                 nombre_producto = boleto_id.name
                                 monto_en_moneda = boleto_id.monto_en_moneda
                                 if class_product.search(cr,uid,[('name', '=', nombre_producto),],context=context):
                                                 continue
                                 else:
                                                 
                                                 
                                                 
                                                 
                                        
                                        print "nombre_producto",nombre_producto                                               
                                        print "nombre_producto",nombre_producto        
                                        
                                        BB = boleto_id
                                        
                                        lista_taxes_nombres = [
                                                        'amount_YQ', 
                                                         'amount_YC',
                                                         'amount_US ', 
                                                         'amount_XA ',
                                                         'amount_XY',
                                                         'amount_AW',
                                                         'amount_VJ',
                                                         'amount_EU',
                                                         'amount_YR',
                                                         'amount_XF',
                                                         'amount_AY',
                                                         'amount_AJ',
                                                         'amount_YN',
                                                         'amount_AK',
                                                         'amount_QC '
                                                         ]
                                        iterar_taxes = 0
                                        tax_ids = []
                                        diccionario_tax = {}
                                        lista111 =[]
                                        lista_tuplas_itinerario =[]
                                        for tax_name in lista_taxes_nombres:
                                                        amount_YQ = BB.amount_YQ
                                                        amount_YC = BB.amount_YC
                                                        amount_US = BB.amount_US
                                                        amount_XA = BB.amount_XA
                                                        amount_XY = BB.amount_XY
                                                        amount_AW = BB.amount_AW
                                                        amount_VJ = BB.amount_VJ
                                                        amount_EU = BB.amount_EU
                                                        amount_YR = BB.amount_YR
                                                        amount_XF = BB.amount_XF
                                                        amount_AY = BB.amount_AY
                                                        amount_AJ = BB.amount_AJ
                                                        amount_YN = BB.amount_YN
                                                        amount_AK = BB.amount_AK
                                                        amount_QC = BB.amount_QC
                                                        
                                                        
                                                        if iterar_taxes == 0:
                                                                  if amount_YQ == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YQ"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YQ)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '251101'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount_YQ,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                        elif iterar_taxes == 1:
                                                                  if amount_YC == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YC"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YC)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '251201'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 2:
                                                                  if amount_US == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_US"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_US)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '251301'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                        
                                                        elif iterar_taxes == 3:
                                                                  if amount_XA == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_XA"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_XA)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2514'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 4:
                                                                  if amount_XY == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_XY"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_XY)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2515'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 5:
                                                                  if amount_AW == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AW"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AW)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2516'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                         
                                                       
                                                                                                 
                                                        elif iterar_taxes == 6:
                                                                  if amount_VJ == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_VJ"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_VJ)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2517'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                          
                                                                                                 
                                                        elif iterar_taxes == 7:
                                                                  if amount_EU == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_EU euuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuUUU"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_EU)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2518'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 8:
                                                                  if amount_YR == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YR"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YR)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2519'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                                      
                                                        elif iterar_taxes == 9:
                                                                  if amount_XF == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_XF"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_XF)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2520'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                                                                        
                                                        elif iterar_taxes == 10:
                                                                  if amount_AY == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AY"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AY)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2521'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                        elif iterar_taxes == 11:
                                                                  if amount_AJ == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AJ"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AJ)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2522'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                                                 
                                                        elif iterar_taxes == 12:
                                                                  if amount_YN == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_YN"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_YN)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2523'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 

                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                                                 
                                                        elif iterar_taxes == 13:
                                                                  if amount_AK == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_AK"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_AK)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2524'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 
                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                         
                                                                                                                  
                                                        elif iterar_taxes == 14:
                                                                  if amount_QC == 0:
                                                                                  print "iterar_taxes" , "00000000000000000000000000000000000000000  #########       QQQQQCCCCCCCCCCCCCCCC  #########"
                                                                                  #continue
                                                                  else:
                                                                        print "iterar_taxes" , "amount_QC ##################       QQQQQCCCCCCCCCCCCCCCC  ####################"
                                                                        amount_type = "fixed"
                                                                        amount = float(amount_QC)
                                                                        name_tax = tax_name
                                                                        print name_tax
                                                                        buscar_tax = self.pool.get('account.account').search(cr,uid,[('code', '=', '2525'),],context=context)
                                                                        account_id = buscar_tax[0]
                                                                        diccionario_tax = {
                                                                                           'name' : name_tax,
                                                                                           'account_id' : account_id,
                                                                                           'type_tax_use' : 'sale',
                                                                                           'amount_type' : "fixed",
                                                                                           'amount':amount,
                                                                                      }
                                                                        TUPLA = (0,id,diccionario_tax) 
                                                                        lista_tuplas_itinerario.append(TUPLA)
                                                                        
                                                                        
                                                                        
                                                                        
                                                        class_tax = self.pool.get('account.tax')  
                                                        buscar_tax = self.pool.get('account.tax').search(cr,uid,[('name', '=', name_tax),],context=context)
                                                        if buscar_tax:
                                                                        id_tax_a_cambiar = buscar_tax[0]
                                                                        tax_idssss = class_tax.write(cr, 1, [id_tax_a_cambiar], {'amount': amount})
                                                        else:
                                                                        tax_idssss = class_tax.create(cr,uid, diccionario_tax)
                                                                        buscar_tax = self.pool.get('account.tax').search(cr,uid,[('name', '=', name_tax),],context=context)
                                                                        id_tax_a_cambiar = buscar_tax[0]
                                                                        
                                                        iterar_taxes += 1
                                                                                     
                                                                        
                                                                     
                                                        
                                                        
                                                                        
                                        class_product = self.pool.get('product.product')
             

                                        class_product.create(cr,uid, {'name': nombre_producto, 'list_price': monto_en_moneda , 'type':'service'  , 'taxes_id' : [(6, 0, lista111)], 'supplier_taxes_id' : [(6, 0, lista111)] })
                                        
                                        clase_producto = self.pool.get('product.product').search(cr,uid,[('name', '=', nombre_producto),],context=context)
                                        
                                        id_producto = clase_producto[0]
                                        
                                        
                                        ### PARTNER
                                       
                                        nombre_partner  =   BB.pasajero
                                    
                                        class_obj_partner = self.pool.get('res.partner')

                                        clase_res_partner = self.pool.get('res.partner').search(cr,uid,[('name', '=', nombre_partner),],context=context)
                                    
           
                                        data6 = {
                                                         'name' : nombre_partner

                                               }
                                    
                                        if clase_res_partner:
                                                    
                                                     id_cliente = clase_res_partner[0]

                                        else:
                                                     print nombre_partner
                                                    
                                                     class_obj_partner.create(cr,uid, data6)
                          
                                                     clase_res_partner = self.pool.get('res.partner').search(cr,uid,[('name', '=', nombre_partner),],context=context)
                                                     id_cliente = clase_res_partner[0]
                                        
                                        
                                        
                                        
                                        print "id_producto", id_producto 
                                        print lista_tuplas_itinerario
                                        
                                        buscar_code = self.pool.get('account.account').search(cr,uid,[('code', '=', '101200'),],context=context)
                                        account_id = buscar_code[0]
                                        
                                        valores_invoice["partner_id"] = id_cliente
                                        
                                        valores_invoice["name"] = nombre_producto
                                        
                                        valores_invoice["journal_id"] = '1'
                                        
                                        valores_invoice["account_id"] = account_id
                                        nro_tax = len(lista_tuplas_itinerario)
                                        if nro_tax == 0:
                                                        pass
                                        elif nro_tax >= 1:
                                                        valores_invoice["tax_line_ids"] = lista_tuplas_itinerario
                                        
                                        invoice_id = class_factura.create(cr,uid, valores_invoice)
                                        
                                        
                                        self.pool.get('account.invoice.line').create(cr, uid,{
                                                                   'invoice_id' : invoice_id,
                                                                   'name' : nombre_producto,
                                                                   'product_id' : id_producto,
                                                                   'price_unit':  monto_en_moneda,
                                                                   'account_id':  account_id,
                                                                    'invoice_line_tax_eds' : (6, id , lista_tuplas_itinerario ) ,
                                                                    #'account_analytic_id': account_analytic_id,
                                                                    })
                                        
                                        
                                        
                                        inv_obj = self.pool.get('account.invoice')
                                        inv_obj.action_date_assign(cr, uid, invoice_id, context=context)
                                        inv_obj.action_move_create(cr, uid, invoice_id, context=context)
                                        inv_obj.invoice_validate(cr, uid, invoice_id, context=context)
                                        
                                        invoice_ids = [(4,[invoice_id])]
                                        amount = BB.total_real
                                        
                                        journal_search = self.pool.get('account.journal').search(cr,uid,[('name', '=', 'Cash'),],context=context)
                                        journal_id = journal_search[0]
                                        #pago_id = self.pool.get('account.payment').create(cr, uid,{
                                                                   #'partner_id' : id_cliente,
                                                                   #'journal_id' : journal_id,
                                                                   #'currency_id' : "3",
                                                                   #'partner_type' : 'customer',
                                                                   #'payment_type':  'inbound',
                                                                   ##'invoice_ids':  invoice_ids,
                                                                   #'payment_method_id':  '1',
                                                                   #'amount':  amount,
                                                                   ##'state':  'posted',
                                                                   
                                                                    ##'taxes_id' : (6, id , lista111 ) ,
                                                                    ##'account_analytic_id': account_analytic_id,
                                                                    #})
                                        
                                        #pago =  self.pool.get('account.payment')
                                        #pago.post(cr, uid, pago_id, context=context)
                                        #inv_obj.write(cr, 1, [invoice_id], {'state': 'paid'})
                                        
                                        nro_iteracion += 1

                                        
                                        
    
    
    name = fields.Char('Nombre')
    nombres= fields.Char('Nombres',size=64 )
    
    #asociar_pnr_id = fields.Many2one('cintas_cat', required=False)
    
                                                                                                        
                                                                                                            
    tipo_pasajero= fields.Char('tipo_pasajero',size=64 )
    pasajero= fields.Char('pasajero',size=64 )

    #Impuestos Desglosados
    amount_YQ  =  fields.Float('amount_YQ', digits=(32, 2))
    amount_YC  =  fields.Float('amount_YC', digits=(32, 2))
    amount_US  =  fields.Float('amount_US', digits=(32, 2))
    amount_XA  =  fields.Float('amount_XA', digits=(32, 2))
    amount_XY  =  fields.Float('amount_XY', digits=(32, 2))
    amount_AW  =  fields.Float('amount_AW', digits=(32, 2))
    amount_VJ  =  fields.Float('amount_VJ', digits=(32, 2))
    amount_EU  =  fields.Float('amount_EU', digits=(32, 2))
    amount_YR  =  fields.Float('amount_YR', digits=(32, 2))
    amount_XF  =  fields.Float('amount_XF', digits=(32, 2))
    amount_AY  =  fields.Float('amount_AY', digits=(32, 2))
    amount_AJ  =  fields.Float('amount_AJ', digits=(32, 2))
    amount_YN  =  fields.Float('amount_YN', digits=(32, 2))
    amount_AK  =  fields.Float('amount_AK', digits=(32, 2))
    amount_QC  =  fields.Float('amount_QC', digits=(32, 2))

    numero_Boleto = fields.Char('numero_Boleto')
    
    #Montos

    sumatoria_desglosados  =  fields.Float('sumatoria_desglosados', digits=(32, 2))
    monto_de_otros_TAX  =  fields.Float('monto_de_otros_TAX', digits=(32, 2))
    total_calculado  =  fields.Float('total_calculado', digits=(32, 2))
    total_real  =  fields.Float('total_real', digits=(32, 2))
    total_CAT  =  fields.Float('total_CAT', digits=(32, 2))
    
    monto_tax_2  =  fields.Float('monto_tax_2', digits=(32, 2))
    monto_tax_1  =  fields.Float('monto_tax_1', digits=(32, 2))
    monto_en_moneda  =  fields.Float('monto_en_moneda', digits=(32, 2))

                                                                                                                  

intermedio_cintas_cat()







########## VOLADOS



class volados(models.Model):
    _name = "volados"
    

     
  
    def create_volados(self, cr, uid, context=None):
                    os.system("ls /home/odoo/archivos_kiu/FLT_descomprimidos   > /home/odoo/archivos_kiu/FLT_descomprimidos.txt")
   
                    archivo_CAT ='/home/odoo/archivos_kiu/FLT_descomprimidos.txt'
                    archi_CAT = open(archivo_CAT,'r') 
                    class_flt_obj = self.pool.get('volados') 
                    class_boletos_flt = self.pool.get('info_volados') 
                    class_PNR_en_flt = self.pool.get('volados') 
                    
                    for archivo_flt_a_extraer in archi_CAT:
                                    #arch_a_extraerle_datos = '/home/odoo/archivos_kiu/CAT/'+archivo_flt_a_extraer
                                    arch_a_extraerle_datos = '/home/odoo/archivos_kiu/FLT_descomprimidos/'+archivo_flt_a_extraer
                                    arch_a_extraerle_datos = arch_a_extraerle_datos.strip()
                                    lista_ticket_numbers = []
                                    agregados = 0
                                    repetidos = 0
                                    Amount_of_Flight_Coupon_total = 0
                                    
                
                                    if archivo_flt_a_extraer:
                                             
                                                                    archivo = arch_a_extraerle_datos
                                                                    reader= open(archivo, 'r')
                                                                    cantidad_archivos  =  0
                                                                    list_total_calculado_REAL = []
                                                                    list_total_real_REAL = []
                                                                    lista_tuplas_boleto = []
                                                                    numeros_K = 0
                                                                    print arch_a_extraerle_datos
                                                                    with open(archivo, 'r') as f:
                                                                                    for row in csv.reader(f.read().splitlines()):
                                                                                                    if row[0] == '1':
                                                                                                                    Record_Indicator = row[0]
                                                                                                                    Version = row[1]
                                                                                                                    Date_of_Processing = row[2]
                                                                                                                    Time_of_Processing = row[3]
                                                                                                                    print " "
                                                                                                                    print "1"                                                           
                                                                                                                    print Record_Indicator, 'Record_Indicator'
                                                                                                                    print Version, 'Version'
                                                                                                                    print Date_of_Processing, 'Date_of_Processing'
                                                                                                                    print Time_of_Processing, 'Time_of_Processing'
                                                                     
                                                                                                   
                                                                                                   #if row[0] == '2':
                                                                                                                    #Record_Indicator = row[0]
                                                                                                                    #Flight_Number = row[1]
                                                                                                                    #Flight_Date = row[2]
                                                                                                                    #Number_of_legs_total = row[3]
                                                                                                                    #print " "
                                                                                                                    #print "2"
                                                                                                                    #print Record_Indicator, 'Record_Indicator'
                                                                                                                    #print Flight_Number, 'Flight_Number'
                                                                                                                    #print Flight_Date, 'Flight_Date'
                                                                                                                    #print Number_of_legs_total, 'Number_of_legs_(total)'
                                                                                        
                    
                            
                                                                                                    if row[0] == '5':
                                                                                                                    Record_Indicator = row[0]
                                                                                                                    Flight_Number = row[1]
                                                                                                                    Flight_Date = row[2]
                                                                                                                    Origin = row[3]
                                                                                                                    Destination = row[4]
                                                                                                                    Type_of_Ticket = row[5]
                                                                                                                    Ticket_Number = row[6]
                                                                                                                    Coupon_Number = row[7]
                                                                                                                    Type_of_Passenger = row[8]
                                                                                                                    Name_of_Passenger = row[9]
                                                                                                                    Passenger_Identification_FOID = row[10]
                                                                                                                    Passenger_Frequent_Flyer_Number = row[11]
                                                                                                                    Reservation_Booking_Designator = row[12]
                                                                                                                    Fare_Basis = row[13]
                                                                                                                    Currency = row[14]
                                                                                                                    Amount_of_Flight_Coupon = row[15]
                                                                                                                    Record_Locator = row[16]
                                                                                                                    Marketing_Flight_Number_2 = row[17]
                                                                                                                    Number_of_Checked_in_Baggage = row[18]
                                                                                                                    Weight_of_Checked_in_Baggage = row[19]
                                                                                                                    Detail_of_Bag_Tag_3 = row[20]
                                                                                                                    print " "
                                                                                                                    print "5"
                                                                                                                    print Record_Indicator, 'Record_Indicator'
                                                                                                                    print Flight_Number, 'Flight_Number'
                                                                                                                    print Flight_Date, 'Flight_Date'
                                                                                                                    print Origin, 'Origin'
                                                                                        
                                                                                                                    print Destination, 'Destination'
                                                                                                                    print Type_of_Ticket, 'Type_of_Ticket'
                                                                                                                    print Ticket_Number, 'Ticket_Number'
                                                                                                                    print Coupon_Number, 'Coupon_Number'
                                                                                        
                                                                                                                    print Type_of_Passenger, 'Type_of_Passenger'
                                                                                                                    print Name_of_Passenger, 'Name_of_Passenger'
                                                                                                                    print Passenger_Identification_FOID, 'Passenger_Identification_FOID'
                                                                                                                    print Passenger_Frequent_Flyer_Number, 'Passenger_Frequent_Flyer_Number'
                                                                                        
                                                                                                                    print Reservation_Booking_Designator, 'Reservation_Booking_Designator'
                                                                                                                    print Fare_Basis, 'Fare_Basis'
                                                                                                                    print Currency, 'Currency'
                                                                                                                    print Amount_of_Flight_Coupon, 'Amount_of_Flight_Coupon'
                                                                                        
                                                                                                                    print Record_Locator, 'Record_Locator'
                                                                                                                    print Marketing_Flight_Number_2, 'Marketing_Flight_Number_2'
                                                                                                                    print Number_of_Checked_in_Baggage, 'Number_of_Checked_in_Baggage'
                                                                                                                    print Weight_of_Checked_in_Baggage, 'Weight_of_Checked_in_Baggage'
                                                                                                                    print Detail_of_Bag_Tag_3, 'Detail_of_Bag_Tag_3'
                                                                                                                    
                                                                                                                    Ticket_Number_vuelo = Ticket_Number + Flight_Number
                                                                                                                    
                                                                                                                    if Ticket_Number_vuelo in lista_ticket_numbers:
                                                                                                                                    repetidos += 1
                                                                                                                                    print "REPETIDOS", repetidos
                                                                                                                                    pass
                                                                                                                    
                                                                                                                    else:
                                                                                                                           dict_datos_tkt = {
                                
                                                                                                                                'Record_Indicator': Record_Indicator,
                                                                                                                                'Flight_Number': Flight_Number,
                                                                                                                                'Flight_Date': Flight_Date,
                                                                                                                                'Origin': Origin,
                                                                                                                                'Destination': Destination,
                                                                                                                                'Type_of_Ticket': Type_of_Ticket,
                                                                                                                                'Ticket_Number': Ticket_Number,
                                                                                                                                'Coupon_Number': Coupon_Number,
                                                                                                                                'Type_of_Passenger': Type_of_Passenger,
                                                                                                                                'Name_of_Passenger': Name_of_Passenger,
                                                                                                                                'Passenger_Identification_FOID': Passenger_Identification_FOID,
                                                                                                                                'Passenger_Frequent_Flyer_Number': Passenger_Frequent_Flyer_Number,
                                                                                                                                'Reservation_Booking_Designator': Reservation_Booking_Designator,
                                                                                                                                'Fare_Basis': Fare_Basis,
                                                                                                                                'Currency': Currency,
                                                                                                                                'Amount_of_Flight_Coupon': Amount_of_Flight_Coupon,
                                                                                                                                'Record_Locator': Record_Locator,
                                                                                                                                'Marketing_Flight_Number_2': Marketing_Flight_Number_2,
                                                                                                                                'Number_of_Checked_in_Baggage': Number_of_Checked_in_Baggage,
                                                                                                                                'Weight_of_Checked_in_Baggage': Weight_of_Checked_in_Baggage,
                                                                                                                                'Detail_of_Bag_Tag_3': Detail_of_Bag_Tag_3,
                                                                                                                                
                                                                                                                               }
                                                                                                                           agregados += 1
                                                                                                                           lista_Amount_of_Flight_Coupon_total = []
                                                                                                                           Amount_of_Flight_Coupon = float(Amount_of_Flight_Coupon)
                                                                                                                           Amount_of_Flight_Coupon_total += Amount_of_Flight_Coupon
                                                                                                                           lista_Amount_of_Flight_Coupon_total.append(Amount_of_Flight_Coupon_total)

                                                                                                                           print "AGREGADOS", agregados
                                                                                                                           
                                                                                                                           lista_ticket_numbers.append(Ticket_Number_vuelo)
                                                                                                                           tupla_datos_boleto = (0, id, dict_datos_tkt)
                                                                                                                           print "                Agregando boleto             ", Name_of_Passenger, Ticket_Number 
                                                                                                                           lista_tuplas_boleto.append(tupla_datos_boleto)
                                                                                                    
                                                                                                    
                                                                                                    elif row[0] == '2':
                                                                                                                    pass


                                                                                                    elif row[0] == '3':
                                                                                                                    pass

                                                                                                    elif row[0] == '4':
                                                                                                                    pass

                                                                                                    elif row[0] == '6':
                                                                                                                    pass

                                                                                                    elif row[0] == '1':
                                                                                                                    pass

                                                                                                    
                                                                    print "Agregar Datos ####################33"     
                                                                    
                                                                    
                                                                                                                    


                                                                    buscar_volados = self.pool.get('volados').search(cr,uid,[('name', '=', archivo_flt_a_extraer),],context=context)
                                                                    if buscar_volados:
                                                                                      continue
                                                                    else:
                                                                                      class_obj_partner = self.pool.get('res.partner')
                                                                                      Amount_of_Flight_Coupon_total = lista_Amount_of_Flight_Coupon_total[0]
                                                                                      print "Amount_of_Flight_Coupon_total", Amount_of_Flight_Coupon_total
                                                                                      class_flt_obj.create(cr,uid, {
                                                                                                                         'name': archivo_flt_a_extraer,
                                                                                                                          'Date_of_Processing': Date_of_Processing,
                                                                                                                          'Record_Indicator': Record_Indicator,
                                                                                                                           'Version': Version,
                                                                                                                            'Time_of_Processing': Time_of_Processing,
                                                                                                                            'boleto_ids': lista_tuplas_boleto,
                                                                                                                            'Amount_of_Flight_Coupon_total': Amount_of_Flight_Coupon_total,
                                                                                                                              }) 
                                                                                      class_journal_object =  self.pool.get('account.move') 
                                                                                      
                                                                                      buscar_journal = self.pool.get('account.journal').search(cr,uid,[('name', '=', 'Miscellaneous Operations'),],context=context) 
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      clase_res_partner = self.pool.get('res.partner').search(cr,uid,[('name', '=', "Vuelos Aruba"),],context=context)
                                                                                      
                                                                                      
           
                                                                                      data6 = {
                                                                                                       'name' : "Vuelos Aruba"

                                                                                             }
                                    
                                                                                      if clase_res_partner:
                                                                                                  
                                                                                                   id_cliente = clase_res_partner[0]

                                                                                      else:
                                                                                                  
                                                                                                   class_obj_partner.create(cr,uid, data6)
                                                                                                   nombre_partner = "Vuelos Aruba"
                          
                                                                                                   clase_res_partner = self.pool.get('res.partner').search(cr,uid,[('name', '=', nombre_partner),],context=context)
                                                                                                   id_cliente = clase_res_partner[0]
                                                                                                   

                                                                                      
                                                                                      account_id = self.pool.get('account.account').search(cr,uid,[('code', '=', '283'),],context=context) 
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      dict_datos_diferidos = {
                                
                                                                                                                                'credit': Amount_of_Flight_Coupon_total,
                                                                                                                                'debit': 0.00,
                                                                                                                                'name': 'Miscellaneous Operations',
                                                                                                                                'partner_id': id_cliente,
                                                                                                                                'account_id': account_id[0],
                                                                                                                                
                                                                                                                                
                                                                                                                               }
                                                                                      lista_tuplas_journal = []
                                                                                      print "AGREGADOS", agregados
                                                                                      tupla_datos_journal = (0, 0, dict_datos_diferidos)
                                                                                      lista_tuplas_journal.append(tupla_datos_journal)
                                                                                                    
                                                                                                    
                                                                                      account_id = self.pool.get('account.account').search(cr,uid,[('code', '=', '51'),],context=context) 
                                                                                      dict_datos_ingresos = {
                                
                                                                                                                                'credit': 0.00,
                                                                                                                                'debit': Amount_of_Flight_Coupon_total,
                                                                                                                                'name': 'Miscellaneous Operations',
                                                                                                                                'partner_id': id_cliente,
                                                                                                                                'account_id': account_id[0],
                                                                                                                                
                                                                                                                               }
                                                                    
                                                                    
                                                                                      print "AGREGADOS", agregados
                                                                                      tupla_datos_journal = (0, 0, dict_datos_ingresos)
                                                                                      lista_tuplas_journal.append(tupla_datos_journal)
                                                                                      print lista_tuplas_journal
                                                                                                                    


                                                                                      
                                                                                      
                                                                                      
                                                                                      
                                                                                      class_journal_object.create(cr,uid, {
                                                                                                                          'journal_id': buscar_journal[0],
                                                                                                                          'partner_id': id_cliente,
                                                                                                                          'line_ids': lista_tuplas_journal,
                                                                                                                              }) 
                                                                                      subprocess.call(['mv', arch_a_extraerle_datos, '/home/odoo/archivos_kiu/FLT_correctamente_procesado'])
                                                                                      print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/FLT_correctamente_procesado", arch_a_extraerle_datos



                                                                        











                    
                    
                    
                    return True
    def move_items_cmas_flt_cat(self, cr, uid, context=None):
                    print "ALGOOOOOOO"
                    os.system("ls /home/odoo/archivos_kiu/ | grep 'CMAS.zip'| grep 'CRS'  >  /home/odoo/archivos_kiu/CMAS_a_Extraer.txt")
                    archivo='/home/odoo/archivos_kiu/CMAS_a_Extraer.txt'
                    archi=open(archivo,'r')
                    lineas=archi.read().splitlines()
                    if len(lineas)> 0:
                                    iteracion = 0
                                    for archivo_cmas_a_extraer in lineas:
                                                    arch_a_extraer = '/home/odoo/archivos_kiu/'+archivo_cmas_a_extraer
                                                    cmas_a_extraer_descomprimido = archivo_cmas_a_extraer[0:-4]
                                                    subprocess.call(['unzip', arch_a_extraer])
                                                    subprocess.call(['mv', arch_a_extraer, '/home/odoo/archivos_kiu/CRS_comprimidos'])
                                                    subprocess.call(['mv', cmas_a_extraer_descomprimido, '/home/odoo/archivos_kiu/CRS_descomprimidos'])
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/CRS_descomprimidos", cmas_a_extraer_descomprimido
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/CRS_comprimidos", arch_a_extraer
                                                    iteracion += 1
                                                

                    os.system("ls /home/odoo/archivos_kiu/ | grep 'CMAS.zip'| grep 'FLT'  >  /home/odoo/archivos_kiu/FLT_a_Extraer.txt")
                    archivo='/home/odoo/archivos_kiu/FLT_a_Extraer.txt'
                    archi=open(archivo,'r')
                    lineas=archi.read().splitlines()
                    if len(lineas)> 0:
                                    
                                    iteracion = 0
                                    for archivo_cmas_a_extraer in lineas:
                                                    arch_a_extraer = '/home/odoo/archivos_kiu/'+archivo_cmas_a_extraer
                                                    cmas_a_extraer_descomprimido = archivo_cmas_a_extraer[0:-4]
                                                    subprocess.call(['unzip', arch_a_extraer])
                                                    subprocess.call(['mv', arch_a_extraer, '/home/odoo/archivos_kiu/FLT_comprimidos'])
                                                    subprocess.call(['mv', cmas_a_extraer_descomprimido, '/home/odoo/archivos_kiu/FLT_descomprimidos'])
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/FLT_descomprimidos", arch_a_extraer
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/FLT_comprimidos", arch_a_extraer
                                                
                                                
                                                    iteracion += 1
                                                    
                    os.system("ls /home/odoo/archivos_kiu/ | grep 'CMAS.zip'| grep 'TID'  >  /home/odoo/archivos_kiu/TID_a_Extraer.txt")
                    archivo='/home/odoo/archivos_kiu/TID_a_Extraer.txt'
                    archi=open(archivo,'r')
                    lineas=archi.read().splitlines()
                    if len(lineas)> 0:
                                    iteracion = 0
                                    for archivo_cmas_a_extraer in lineas:
                                                    arch_a_extraer = '/home/odoo/archivos_kiu/'+archivo_cmas_a_extraer
                                                    subprocess.call(['mv', arch_a_extraer, '/home/odoo/archivos_kiu/archivos_comprimidos_TID'])
                                                   
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/archivos_comprimidos_TID", arch_a_extraer
                                                
                                                
                                                    iteracion += 1
                                                                            

                    os.system("ls /home/odoo/archivos_kiu/ | grep 'CAT.zip'| grep 'CRS'  >  /home/odoo/archivos_kiu/CAT_a_Extraer.txt")
                    archivo='/home/odoo/archivos_kiu/CAT_a_Extraer.txt'
                    archi=open(archivo,'r')
                    lineas=archi.read().splitlines()
                    if len(lineas)> 0:
                                    iteracion = 0
                                    for archivo_cmas_a_extraer in lineas:
                                                    
                                                    arch_a_extraer = '/home/odoo/archivos_kiu/'+archivo_cmas_a_extraer
                                                    cmas_a_extraer_descomprimido = archivo_cmas_a_extraer[0:-4]
                                                    subprocess.call(['unzip', arch_a_extraer])
                                                    subprocess.call(['mv', cmas_a_extraer_descomprimido, '/home/odoo/archivos_kiu/FLT_comprimidos'])
                                                    subprocess.call(['mv', arch_a_extraer, '/home/odoo/archivos_kiu/FLT_comprimidos'])
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/CAT_descomprimidos", arch_a_extraer
                                                    print "MOVIENDO ARCHIVO A /home/odoo/archivos_kiu/CAT_comprimidos", arch_a_extraer
                                                    iteracion += 1
                                                


                                                


### Informacion Importante

    Amount_of_Flight_Coupon_total = fields.Float('Amount_of_Flight_Coupon_total')
    name = fields.Char('Nombre de Archivo')
    Date_of_Processing = fields.Char('Date_of_Processing')
    Record_Indicator = fields.Char('Record_Indicator')
    Version = fields.Char('Version')
    #apellidos= fields.Char('Apellidos',size=64 )
    #titulo= fields.Char('Titulo',size=64 ,  help='Solo debe elegir 1 por ejemplo Ing, Lic u otro, aqui van las 3 letras del titulo universitario obtenido')
    #edad = fields.Integer('Edad')

    
    
    boleto_ids = fields.One2many('info_volados','asociar_pnr_id')

volados()


class info_volados(models.Model):
    _name = "info_volados"
    name = fields.Char('Nombre')
    nombres= fields.Char('Nombres',size=64 )
    
    
    Record_Indicator= fields.Char('Record_Indicator',size=64 )
    Flight_Number= fields.Char('Flight_Number',size=64 )
    Origin= fields.Char('Origin',size=64 )
    Destination= fields.Char('Destination',size=64 )
    Type_of_Ticket= fields.Char('Type_of_Ticket',size=64 )
    Ticket_Number= fields.Char('Ticket_Number',size=64 )
    Coupon_Number= fields.Char('Coupon_Number',size=64 )
    Type_of_Passenger= fields.Char('Type_of_Passenger',size=64 )
    Name_of_Passenger= fields.Char('Name_of_Passenger',size=64 )
    Passenger_Identification_FOID= fields.Char('Passenger_Identification_FOID',size=64 )
    Passenger_Frequent_Flyer_Number= fields.Char('Passenger_Frequent_Flyer_Number',size=64 )
    Reservation_Booking_Designator= fields.Char('Reservation_Booking_Designator',size=64 )
    Fare_Basis= fields.Char('Fare_Basis',size=64 )
    Currency= fields.Char('Currency',size=64 )
    Record_Locator= fields.Char('Record_Locator',size=64 )
    Marketing_Flight_Number_2= fields.Char('Marketing_Flight_Number_2',size=64 )
    Number_of_Checked_in_Baggage= fields.Char('Number_of_Checked_in_Baggage',size=64 )
    Weight_of_Checked_in_Baggage= fields.Char('Weight_of_Checked_in_Baggage',size=64 )
    Detail_of_Bag_Tag_3= fields.Char('Detail_of_Bag_Tag_3',size=64 )
    Flight_Date= fields.Char('Flight_Date',size=64 )

    Amount_of_Flight_Coupon= fields.Float('Amount_of_Flight_Coupon',digits=(32, 2) )

    
    
    
    asociar_pnr_id = fields.Many2one('volados', required=False)
                    
                                                                                                                  

info_volados()



